[toc]

# ğŸŒ²C++å“ˆå¸Œ

> **ä¸‹é¢æŠŠæ”¾å…¥å“ˆå¸Œè¡¨ä¸­çš„å€¼è®°ä¸ºkeyï¼Œindexæ˜¯keyåœ¨å“ˆå¸Œè¡¨ä¸­çš„ä½ç½®**

## ğŸŒ´å“ˆå¸Œå†²çª

ä¸¤ä¸ªkeyé€šè¿‡åŒä¸€ä¸ªæ˜ å°„å…³ç³»å¾—åˆ°äº†ç›¸åŒçš„å€¼ï¼Œå³ä»–ä»¬éœ€è¦æ”¾åœ¨åŒä¸€ä¸ªä½ç½®ï¼ˆé€šè¿‡keyç®—å‡ºçš„indexä¸€æ ·ï¼‰ï¼Œè¿™å°±æ˜¯å“ˆå¸Œå†²çªã€‚

ç®€è€Œè¨€ä¹‹ï¼Œ**ä¸åŒå€¼æ˜ å°„åˆ°äº†åŒä¸€ä¸ªä½ç½®**.

> å“ˆå¸Œè¡¨çš„æ•ˆç‡ä¸å“ˆå¸Œå†²çªçš„å¤„ç†å¯†åˆ‡ç›¸å…³
>
> ä¸¾ä¸ªä¾‹å­ï¼Œå“ˆå¸Œè¡¨å¤§å°ä¸º10ï¼Œa[]={1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ15}ï¼Œå®šä¹‰å“ˆå¸Œç®—æ³•ä¸º index=key%è¡¨é•¿ï¼Œä»å‰å¾€åæ„é€ å“ˆå¸Œè¡¨ã€‚
>
> å³æ•°ç»„ä»å‰å¾€åç®—å‡ºçš„indexåˆ†åˆ«ä¸º1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ5ï¼Œæ­¤æ—¶key=15çš„å…ƒç´ ç®—å‡ºçš„indexä¸º5ï¼Œä½†æ˜¯5è¿™ä¸ªä½ç½®å·²ç»æœ‰äº†keyä¸º5çš„å…ƒç´ ï¼Œè¿™å°±æ˜¯å“ˆå¸Œå†²çª

## ğŸŒ´è´Ÿè½½å› å­

è´Ÿè½½å› å­=å“ˆå¸Œè¡¨ä¸­å…ƒç´ çš„ä¸ªæ•°/å“ˆå¸Œè¡¨çš„å¤§å°

> æ˜¾ç„¶è´Ÿè½½å› å­å°äº1ï¼Œå¹¶ä¸”è´Ÿè½½å› å­è¶Šå¤§è¶Šå®¹æ˜“äº§ç”Ÿå“ˆå¸Œå†²çªï¼ˆä¸¤ä¸ªæ•°æ”¾åˆ°ä¸€ä¸ªä½ç½®çš„æ¦‚ç‡æ›´å¤§ï¼Œå¤§å°ä¸º10çš„å®¹å™¨é‡Œæ”¾9ä¸ªæ•°å†²çªæ¦‚ç‡è‚¯å®šæ¯”æ”¾ä¸€ä¸ªæ•°å¤§ï¼‰

## ğŸŒ´å“ˆå¸Œå‡½æ•°

ä¸€èˆ¬é‡‡ç”¨é™¤ç•™ä½™æ•°æ³•ï¼Œå³å–æ¨¡çš„æ–¹æ³•ï¼Œå¦‚keyå¯¹è¡¨é•¿è¿›è¡Œå–æ¨¡å¾—åˆ°indexã€‚

æ­¤å¤–è¿˜æœ‰å¾ˆå¤šç§ï¼Œå¦‚å¹³æ–¹å–ä¸­ï¼Œéšæœºæ•°æ³•ç­‰ç­‰

## ğŸŒ´é—­æ•£åˆ—

é—­æ•£åˆ—ä¹Ÿå«å¼€æ”¾åœ°å€æ³•ï¼Œå‘ç”Ÿå“ˆå¸Œå†²çªæ—¶åªè¦å“ˆå¸Œè¡¨æ²¡æ»¡åˆ™è¯´æ˜å“ˆå¸Œè¡¨ä¸­å¿…æœ‰ä¸€ä¸ªç©ºä½ç½®å­˜æ”¾è¿™ä¸ªå€¼

### ğŸŒµå¤„ç†å“ˆå¸Œå†²çª

çº¿æ€§æ¢æµ‹å’ŒäºŒæ¬¡æ¢æµ‹ã€‚

> è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯å‘ç”Ÿäº†å“ˆå¸Œå†²çªæ‰ç”¨çš„ä¸Šçš„.

#### ğŸŒµçº¿æ€§æ¢æµ‹

ç®—å‡ºçš„indexå¾€åæŒ¨ä¸ªæ‰¾ï¼Œæ‰¾åˆ°ä¸€ä¸ªç©ºä½ç½®æ”¾å…¥å³å¯ã€‚

![çº¿æ€§æ¢æµ‹](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/%E7%BA%BF%E6%80%A7%E6%8E%A2%E6%B5%8B.gif)

#### ğŸŒµäºŒæ¬¡æ¢æµ‹

ç®—å‡ºçš„indexä¾æ¬¡åŠ 1ï¼Œ4ï¼Œ9ï¼Œ...è¿™ç§æ•°ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªç©ºä½ç½®

> äºŒæ¬¡æ¢æµ‹æ”¾å…¥çš„æ•°æ®æ›´æ•£ï¼Œä½†æ˜¯å¯èƒ½æ­»å¾ªç¯ï¼ˆä»£ç æµ‹è¯•äºŒæ¬¡æ¢æµ‹æ—¶ä¸€ç»„æ•°æ®æ­»å¾ªç¯äº†ï¼‰

![äºŒæ¬¡æ¢æµ‹](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/%E4%BA%8C%E6%AC%A1%E6%8E%A2%E6%B5%8B.gif)

#### ğŸŒµå…¶å®ƒ

è¿˜æœ‰åˆ«çš„åŠæ³•è§£å†³å“ˆå¸Œå†²çªï¼Œé—­æ•£åˆ—ä¸»è¦ç”¨çš„ä¸Šé¢ä¸¤ç§ï¼Œ

## ğŸŒ´ä»£ç å®ç°

### ğŸŒµç»“ç‚¹

```c++
template<class K, class V>
struct HashData
{
	pair<K, V> _kv;
	Status _status = EMPTY;
};
```

ç»“ç‚¹çš„ä¸‰ç§çŠ¶æ€

```c++
enum Status//å®šä¹‰ä¸€ä¸‹ç»“ç‚¹çš„çŠ¶æ€ï¼Œæ–¹ä¾¿æ“ä½œ
{
	EMPTY,
	EXIST,
	DELETE
};
```



### ğŸŒµå†…ç½®ç±»å‹ä»¥å¤–ç±»å‹çš„æ˜ å°„å€¼å¤„ç†

å†…ç½®ç±»å‹ä»¥å¤–çš„ç±»å‹å°±æ˜¯è‡ªå®šä¹‰ç±»å‹å’Œåº“é‡Œçš„ä¸€äº›ç±»å‹å¦‚pairå’Œstringç­‰

**æˆ‘ä»¬åˆ©ç”¨ä»¿å‡½æ•°å¾—åˆ°ç›¸åº”çš„å€¼**

```c++
template<class K>
struct HashFunc
{
	const K& operator()(const K& key)
	{
		return key;
	}
};
template<>//å¯¹å­—ç¬¦ä¸²è¿›è¡Œç‰¹åŒ–ï¼Œæ¨¡æ¿è¿›é˜¶çš„å†…å®¹
struct HashFunc <string>
{
	size_t operator()(const string& key)
	{
		size_t value = 0;
		for (auto e : key)
		{
			value = value * 13 + (size_t)e;//ä¹˜ä»¥131æ˜¯BKDRå‘æ˜çš„å­—ç¬¦ä¸²å“ˆå¸Œç®—æ³•ï¼Œ*131ç­‰æ•°æ•ˆç‡æ›´é«˜
		}
		return value;
	}
};
```

ä»¿å‡½æ•°ä¼ å…¥keyè¿”å›keyæœ‰å•¥ç”¨ï¼Ÿ

ä»¥ä¸€èˆ¬ç±»å‹ä¸ºä¾‹ï¼Œå¦‚intï¼Œdoubleç­‰ä¼ è¿›å»ç›´æ¥è¿”å›å®ƒä»¬æœ¬èº«çš„å€¼ï¼Œå› ä¸ºä»–ä»¬æœ¬èº«å°±æ˜¯keyã€‚å¦‚STLä¸­çš„setå’Œunordered_setã€‚

ä½†æ˜¯å¦‚æœè¦ä¼ å…¥pairå‘¢ï¼Ÿé‚£å°±å¾—æˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªä»¿å‡½æ•°ï¼ˆå¦‚åŒå¤„ç†stringä¸€æ ·ï¼‰ï¼Œå¯ä»¥å†™æˆä¸‹é¢è¿™æ ·

```c++
template<class K,class V>
struct HashFunc
{
	const K& operator()(const pair<const K,V>& kv)
	{
		return kv.first;
	}
};
```

> ä»¿å‡½æ•°å†™äº†å¦‚ä½•ç”¨ï¼Ÿä¼ å‚æ—¶ä¼ å…¥è¿™ä¸ªstructä½œä¸ºæ¨¡æ¿å‚æ•°ã€‚
>
> ![image-20220520002710373](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220520002710373.png)
>
> 

### ğŸŒµç»“æ„

```c++
	template<class K>
	struct HashFunc
	{
		const K& operator()(const K& key) ;
	};
	template<>
	struct HashFunc <string>
	{
		size_t operator()(const string& key);
	};
	enum Status//å®šä¹‰ä¸€ä¸‹ç»“ç‚¹çš„çŠ¶æ€ï¼Œæ–¹ä¾¿æŸ¥æ‰¾
	{
		EMPTY,
		EXIST,
		DELETE
	};	
	template<class K, class V>
	struct HashData
	{
		pair<K, V> _kv;
		Status _status = EMPTY;
	};
	template<class K,class V,class Hash=HashFunc<K>>
	class HashTable
	{
	public:
		HashData<K, V>* Find(const K& key);
		bool Insert(const pair<K, V>& kv);
		bool Erase(const K& key);	
	private:
		vector<HashData<K,V>>_tables;
		size_t _n = 0;
	};
```

###  ğŸŒµæŸ¥æ‰¾

æ€è·¯ï¼šå…ˆç®—å‡ºkeyå¯¹åº”çš„indexï¼Œå¦‚æœè¿™ä¸ªä½ç½®å­˜åœ¨ä¸”keyä¸è¦æŸ¥æ‰¾çš„keyç›¸ç­‰å°±è¯´æ˜æ‰¾åˆ°äº†ï¼Œå¦åˆ™å¾€åæ‰¾ï¼Œæ‰¾åˆ°ç©ºçš„ä½ç½®è¯´æ˜è¡¨ä¸­ä¸å­˜åœ¨è¿™ä¸ªkeyã€‚

```c++
	HashData<K, V>* Find(const K& key)
	{
		if (_tables.size() == 0)
		{
			return nullptr;
		}
		
		Hash hash;
		size_t start = hash(key) % _tables.size();
		size_t i = 0;
		size_t index = start + i;//ç®—å‡ºçš„index
		while (_tables[index]._status != EMPTY)//è¿™ä¸ªä½ç½®ä¸ä¸ºç©º
		{
			if (_tables[index]._kv.first == key
				&& _tables[index]._status == EXIST)//å­˜åœ¨ä¸”å€¼ç›¸ç­‰
                //åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ˜¯å› ä¸ºç»“ç‚¹æœ‰ä¸€ç§å¯èƒ½çš„çŠ¶æ€æ˜¯åˆ é™¤
			{
				return &_tables[index];
			}
			else
			{
				++i;
				//index = start + i; // çº¿æ€§æ¢æµ‹
				index = start + i * i; // äºŒæ¬¡æ¢æµ‹
				index %= _tables.size();
			}
		}
		
		return nullptr;
	}
```

### ğŸŒµæ’å…¥

æ€è·¯ï¼šæ‰¾åˆ°ä¸€ä¸ªç©ºä½ç½®ç›´æ¥æ”¾

å…·ä½“æ¥è¯´ï¼Œä½ç½®ä¸ºç©ºç›´æ¥æ”¾ï¼Œå¦‚æœæ‰¾åˆ°çš„ä½ç½®å·²ç»æœ‰å€¼äº†å°±é€šè¿‡çº¿æ€§æ¢æµ‹/äºŒæ¬¡æ¢æµ‹å»åé¢æ‰¾ä½ç½®

> å€¼å¾—æ³¨æ„çš„ç‚¹æ˜¯è´Ÿè½½å› å­æ˜¯0.7çš„æ—¶å€™æˆ–è€…åˆšå¼€å§‹è¡¨é•¿åº¦ä¸º0çš„æ—¶å€™å¾—è¿›è¡Œå¢å®¹
>
> å¢å®¹æ‹·è´åŸå“ˆå¸Œè¡¨æ•°æ®çš„æ–¹æ³•ï¼šå¼€ä¸€ä¸ªæ–°è¡¨ï¼Œè°ƒç”¨Insertå‡½æ•°æ’å…¥æ•°æ®åˆ°æ–°è¡¨ä¸­ï¼Œå†äº¤æ¢æ–°è¡¨å’Œæ—§è¡¨å³å¯ã€‚ï¼ˆvectorçš„äº¤æ¢åªäº¤æ¢æŒ‡é’ˆï¼Œæ‰€ä»¥å¼€é”€ä¸å¤§ï¼‰
>
> **å¢å®¹åè¡¨é•¿å˜åŒ–ï¼Œå¯¼è‡´indexä¹Ÿè¦è·Ÿç€å˜ï¼Œç›´æ¥ç”¨æ–°è¡¨æ’å…¥å°±è§£å†³äº†è¿™ä¸ªé—®é¢˜**

```c++
		bool Insert(const pair<K, V>& kv)
		{
			Hash hash;
			if (Find(kv.first))//åŸæ¥çš„è¡¨ä¸­å­˜åœ¨
			{
				return false;
			}
			if (_tables.size()==0||_n*10/_tables.size()>=7)
				//è´Ÿè½½å› å­åœ¨0.7çš„æ—¶å€™æ‰©å®¹ ä¸ç„¶å¯èƒ½å¯¼è‡´æ­»å¾ªç¯
			{
				size_t newsize = _tables.size() == 0 ? 10 : _tables.size() * 2;
				
				HashTable<K, V, Hash>NewHT;//æä¸€ä¸ªvectorå‡ºæ¥è¡Œå—ï¼Ÿå¯ä»¥ï¼Œä½†æ˜¯é€‰ç”¨hashtableåé¢å¯ä»¥ç›´æ¥è°ƒç”¨Insertæ’å…¥æ•°æ®æ›´æ–¹ä¾¿
				NewHT._tables.resize(newsize);
				for (auto& e : _tables)//è¿™ç§ä¼ å¼•ç”¨ ä¸ä¼ å¼•ç”¨å¾—å¤šæ‹·è´ä¸€æ¬¡
				{
					NewHT.Insert(e._kv);
				}
				_tables.swap(NewHT._tables);//äº¤æ¢ä¹‹åNewHTå°±è¢«é”€æ¯äº†
			}
			size_t start = hash(kv.first) % _tables.size();
			size_t i = 0;
			size_t index = start + i;
			//è¿›è¡Œçº¿æ€§æ¢æµ‹æˆ–äºŒæ¬¡æ¢æµ‹
			while (_tables[index]._status==EXIST)//ä¸ç­‰äºç©ºå°±ä¸€ç›´å¾€åèµ°
			{
				//index++;//ç”±äºè´Ÿè½½å› å­åœ¨0.7æ—¶æ‰©å®¹äº†æ‰€ä»¥ä¸ä¼šæ­»å¾ªç¯.
				i++;
				//index = start + i çº¿æ€§æ¢æµ‹
				index = start+i*i;
				index %= _tables.size();
			}
			//æ‰¾åˆ°ä½ç½®äº†
			
			_tables[index]._status = EXIST;
			_tables[index]._kv = kv;
			_n++;
			return true;
		}
```



### ğŸŒµåˆ é™¤

> å¤ç”¨Find()å³å¯ï¼Œè¿™é‡Œæ˜¯ä¸€ç§ä¼ªåˆ é™¤ï¼Œåªæ˜¯æ›´æ”¹ç»“ç‚¹çŠ¶æ€è€Œä¸æ˜¯åˆ é™¤æ•°æ®ã€‚

```c++
bool Erase(const K& key)
		{
			
			/*	Hash hs;
				size_t index = hs(key) % _tables.size();
				while (_tables[index]._status==EXIST)
				{
					if (_tables[index]._kv.first == key)
					{
						_tables[index]._status = DELETE;
						return true;
					}
					index++;//çº¿æ€§æ¢æµ‹
					index %= _tables.size();
				}
				return false;*/
			HashData<K, V>* ret = Find(key);
			if (ret == nullptr)
			{
				return false;
			}
			else
			{
				ret->_status = DELETE;
				return true;
			}
		}
```

### ğŸŒµæµ‹è¯•

æµ‹è¯•æ•´å½¢

```c++
	void test1()
	{
		int a[] = { 5, 3, 100, 9999, 333, 14, 26, 34, 5};//è¿™ç»„æ•°æ®åœ¨äºŒæ¬¡æ¢æµ‹æ—¶ä¼šæ­»å¾ªç¯
		HashTable<int, int> ht;
		for (auto e : a)
		{
			ht.Insert(make_pair(e, e));
		}

		ht.Erase(3);
		cout << ht.Find(3) << endl;
	}
```

æµ‹è¯•å­—ç¬¦ä¸²

```cpp
void test2()
{
	HashTable<string, string, HashFunc<string>>ht;
	ht.Insert(make_pair("sort", "æ’åº"));
	ht.Insert(make_pair("entity", "å®ä½“"));
	ht.Insert(make_pair("object", "å¯¹è±¡"));
	ht.Insert(make_pair("buffer", "ç¼“å†²"));
	ht.Erase("sort");
	cout << ht.Find("sort") << endl;
}
```

### ğŸŒµææ„ï¼Œæ‹·è´æ„é€ ï¼Œæ„é€ å‡½æ•°

ææ„ï¼Œç»“æ„é€‰ç”¨äº†vectorï¼Œvectorä¼šå¸®æˆ‘ä»¬æå®š

æ‹·è´æ„é€ ,æ²¡æœ‰æ¶‰åŠåˆ°æ·±æµ…æ‹·è´æ„é€ ï¼Œvectorä¼šå¸®æˆ‘ä»¬æå®š

æ„é€ å‡½æ•°ï¼Œç»™äº†ç¼ºçœå€¼ï¼Œä¹Ÿæ²¡å•¥è¦ä¼ å‚åˆå§‹åŒ–çš„æƒ…å†µï¼Œé»˜è®¤çš„ä¹Ÿå¤Ÿç”¨ã€‚

> é—­æ•£åˆ—çš„å“ˆå¸Œè¡¨å¯ä»¥ç†è§£ä¸ºå¯¹vectorè¿›è¡Œäº†ä¸€æ¬¡å°è£…ï¼Œvectorçš„å…ƒç´ å“ˆå¸Œç»“ç‚¹ä¹Ÿæ²¡å¼€è¾Ÿä»€ä¹ˆç©ºé—´ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šå‡ºç°å†…å­˜æ³„æ¼çš„é—®é¢˜ï¼Œä½†æ˜¯å¼€æ•£åˆ—é‡‡ç”¨é“¾è¡¨çš„ç»“æ„ï¼ˆé“¾è¡¨æ˜¯è‡ªå·±å†™çš„ï¼‰ï¼Œæ‰€ä»¥éœ€è¦è‡ªå·±å»é‡Šæ”¾é“¾è¡¨çš„ç©ºé—´ã€‚

## ğŸŒ´å¼€æ•£åˆ—ï¼ˆå“ˆå¸Œæ¡¶ï¼‰

> STLé‡Œçš„unordered_setå’Œunordered_mapåº•å±‚çš„å“ˆå¸Œå°±é€‰ç”¨äº†å¼€æ•£åˆ—ç»“æ„

### ğŸŒµå¤„ç†å“ˆå¸Œå†²çª

é‡‡ç”¨é“¾è¡¨çš„å½¢å¼

![image-20220520171854746](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220520171854746.png)

- é‚£å¼€æ•£åˆ—çš„ç»“æ„æ˜¯ä¸æ˜¯ä¸éœ€è¦æ‰©å®¹ï¼Ÿ

éœ€è¦çš„ã€‚ä»¥ä¸Šå›¾ä¸ºä¾‹ï¼Œè¡¨é•¿å°±ä¸º10ï¼Œæˆ‘è¦æ”¾10000ä¸ªæ•°æ®ï¼Œå¹³å‡ä¸‹æ¥å°±ç®—æ¯ä¸ªé“¾è¡¨æ”¾1000ä¸ªï¼Œé‚£æŸ¥æ‰¾å’Œåˆ é™¤æŒ‡å®šå…ƒç´ çš„æ•ˆç‡ä¾æ—§ä¸é«˜ã€‚

- é‚£éœ€è¦å¢å®¹çš„è¯ä»€ä¹ˆæ—¶å€™å¢å®¹ï¼Ÿ

è´Ÿè½½å› å­ä¸º1æ—¶å¢å®¹

> STLåº“é‡Œé»˜è®¤æ˜¯1
>
> ![image-20220520172601023](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220520172601023.png)

##  ğŸŒ´ä»£ç å®ç°

#### ğŸŒµç»“ç‚¹

å“ˆå¸Œè¡¨é‡‡ç”¨vectorå­˜å‚¨ï¼Œvectorçš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨çš„æ¯ä¸ªå…ƒç´ å³æ˜¯å“ˆå¸Œç»“ç‚¹

é‚£ä¹ˆè¿™ä¸ªç»“ç‚¹è‚¯å®šéœ€è¦æœ‰nextæŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªï¼Œåˆè¦å­˜å‚¨ç±»å‹çš„å€¼ï¼Œè¿™é‡Œçš„ç±»å‹é‡‡ç”¨pair<K,V>,æ‰€ä»¥å°±æœ‰äº†pair<K,V>

> é“¾è¡¨ä¹Ÿå¯ä»¥ç”¨åŒå‘å¾ªç¯é“¾è¡¨ï¼Œå•é“¾è¡¨ç®€å•ç‚¹ï¼Œæ ¹æ®æ³›å‹ç¼–ç¨‹çš„æ€æƒ³å¯ä»¥æŠŠpairæ”¹æˆæ¨¡æ¿ã€‚

```c++
struct HashNode
{
	pair<K, V> _kv;
	HashNode* _next;
	HashNode(const pair<K,V>& kv)
		:_kv(kv)
		:next(nullptr)
	{}
};
```

#### ğŸŒµç»“æ„

> namespace open_hashä¹Ÿè¡Œ å¼€æ•£åˆ— ï¼Œä½†æ˜¯å‘½åç©ºé—´å–ä¸ºå“ˆå¸Œæ¡¶æ›´åŠ å½¢è±¡ï¼Œæ¯ä¸ªæ¡¶éƒ½æ˜¯ä¸€ä¸ªé“¾è¡¨

```c++
namespace HashBucket//é˜²æ­¢ä¸åº“é‡Œçš„ä¸€äº›åå­—ç›¸åŒå¯¼è‡´å‘½åå†²çª
{
	template<class K,class V,class Hash=HashFunc<K>>
	struct HashNode
	{
		pair<K, V> _kv;
		HashNode* _next;
		HashNode(const pair<K, V>& kv)
			:_kv(kv)
			: next(nullptr)
		{}
	};
	template<class K,class V>
	class HashTable
	{
		typedef HashNode<K,V> Node;
	public:

		Node* Find(const K& key)//Findå‡½æ•°è¿”å›å€¼ä¸€èˆ¬éƒ½æ˜¯æŒ‡é’ˆï¼Œé€šè¿‡æŒ‡é’ˆè®¿é—®è¿™ä¸ªè‡ªå®šä¹‰ç±»å‹çš„æˆå‘˜
		{

		}
		bool Insert(const pair<K, V>& kv)
		{

		}
		bool Erase(const K& key)
		{

		}
		~HashTable()//å“ˆå¸Œæ¡¶é‡‡ç”¨çš„é“¾è¡¨ç»“æ„ éœ€è¦é‡Šæ”¾æ¯ä¸ªé“¾è¡¨
		{

		}
	private:
		vector<Node*>_tables;//å­˜çš„æ˜¯é“¾è¡¨é¦–å…ƒç´ çš„æŒ‡é’ˆ
		size_t n;//æœ‰æ•ˆæ•°æ®
	};

}
```

> æ‹·è´æ„é€ å’Œèµ‹å€¼å•é‡è½½åé¢ç‹¬å®ç°

####  ğŸŒµæŸ¥æ‰¾

æ€æƒ³ï¼šå…ˆè®¡ç®—å‡ºæ¡¶å·ï¼ˆå¯¹åº”çš„indexï¼‰ï¼Œéå†æ¡¶å·å¯¹åº”çš„è¿™æ ¹é“¾è¡¨ï¼Œçœ‹æ˜¯å¦èƒ½æ‰¾åˆ°è¿™ä¸ªå€¼

```c++
Node* Find(const K& key)//Findå‡½æ•°è¿”å›å€¼ä¸€èˆ¬éƒ½æ˜¯æŒ‡é’ˆï¼Œé€šè¿‡æŒ‡é’ˆè®¿é—®è¿™ä¸ªè‡ªå®šä¹‰ç±»å‹çš„æˆå‘˜
{
	Hash hash;//æŠŠstringä¹‹ç±»çš„ç±»å‹æ˜ å°„æˆæ•´æ•°ï¼Œå³å¤„ç†å†…ç½®ç±»å‹ä»¥å¤–çš„ç±»å‹
	if (_tables.size() == 0)//è¡¨çš„å¤§å°ä¸º0ï¼Œé˜²æ­¢å–ä½™0
	{
		return nullptr;
	}
	size_t index = hash(key) % _tables.size();//æ‰¾åˆ°æ¡¶å·
	Node* cur = _tables[index];
	while (cur)
	{
		if (cur->_kv.first == key)
		{
			return cur;
		}
		else
		{
			cur = cur->_next;
		}
	}
	return nullptr;
}
```



#### ğŸŒµæ’å…¥

æ€è·¯ï¼šå…ˆå»æ¡¶é‡Œæ‰¾ï¼Œå»çœ‹çœ‹æœ‰æ²¡æœ‰è¿™ä¸ªå€¼ï¼Œå¦‚æœæœ‰ç›´æ¥è¿”å›falseã€‚æ²¡æœ‰çš„è¯ç®—å‡ºåº”è¯¥æ”¾å…¥çš„æ¡¶ï¼Œå†å°†è¿™ä¸ªç»“ç‚¹è¿›è¡Œå¤´æ’ï¼Œæ’å…¥å‰éœ€è¦æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹ã€‚

> ä¸ºä»€ä¹ˆè¿›è¡Œå¤´æ’ä¸è¿›è¡Œå°¾æ’ï¼Ÿå› ä¸ºå°¾æ’è¦æ‰¾å°¾ï¼Œç”±äºé‡‡ç”¨çš„æ˜¯å•é“¾è¡¨æ‰¾å°¾å¾—éå†è¿™ä¸ªé“¾è¡¨æ›´éº»çƒ¦
>
> æ€ä¹ˆè¿›è¡Œæ‰©å®¹ï¼Ÿå–å‡ºåŸæ¥è¡¨çš„æ¯ä¸ªç»“ç‚¹æ’å…¥æ–°è¡¨ï¼Œå†äº¤æ¢æ–°æ—§ä¸¤ä¸ªè¡¨
>
> æ³¨æ„**æ‰©å®¹åè¡¨é•¿å˜åŒ–å¯¼è‡´indexå˜åŒ–**ï¼Œæ¯”å¦‚åŸæ¥è¡¨é•¿æ˜¯10ï¼Œæ¨¡10å°±è¡Œäº†ï¼Œç°åœ¨è¡¨é•¿æ‰©å®¹æˆäº†20ï¼Œå°±å¿…é¡»å»æ¨¡20äº†ã€‚åŒæ—¶ä¸€äº›æœ¬æ¥åœ¨åŒä¸€ä¸ªæ¡¶çš„ç»“ç‚¹ä¹Ÿå¯èƒ½ä¸åœ¨åŒä¸€ä¸ªæ¡¶äº†ã€‚

```c++
bool Insert(const pair<K, V>& kv)
{
	if (Find(kv.first))//æœ‰ç›¸åŒçš„keyç›´æ¥è¿”å›false
	{
		return false;
	}
	//if(_n==0||_n==_tables.size())
	Hash hash;
	if (_n == _tables.size())//æœ€å¼€å§‹_nä¸º0ï¼Œè€Œ_tables.size()ä¹Ÿä¸º0æ‰€ä»¥å¯ä»¥ç®€åŒ–ä¸ºä¸€è¡Œä»£ç 
        //è´Ÿè½½å› å­ä¸º1æ˜¯å¢å®¹
	{
		//å¢å®¹
		size_t newSize = _tables.size() == 0 ? 10 : _tables.size() * 2;
		vector<Node*>newTables;
		newTables.resize(newSize, nullptr);
		for (int i = 0; i < _tables.size(); i++)
		{
			Node* cur = _tables[i];
			while (cur)
			{
				Node* next = cur->_next;//è®°å½•ä¸‹ä¸€ä¸ªä½ç½®
				size_t index = hash(cur->_kv.first) % newTables.size();
				cur->_next = newTables[index];//curå½“å¤´
				newTables[index] = cur;//æ›´æ–°vectoré‡Œçš„å¤´
				cur = next;
			}
		}
		_tables.swap(newTables);//æŠŠæ–°è¡¨çš„æ•°æ®æ”¾å…¥æ—§è¡¨ä¸­
        //æ€è€ƒnewTableå­˜åœ¨å†…å­˜æ³„æ¼å—ï¼Ÿ
        //newTableç”Ÿå‘½å‘¨æœŸç»“æŸåè°ƒç”¨è‡ªå·±çš„ææ„å‡½æ•°ï¼Œåˆå› ä¸ºnewTableäº¤æ¢åæ¯æ¡é“¾è¡¨æœ€å¤šä¸€ä¸ªç»“ç‚¹ï¼Œæ‰€ä»¥é»˜è®¤çš„ç»“ç‚¹çš„ææ„å°±å¤Ÿç”¨ã€‚æ³¨æ„ï¼šäº¤æ¢åä¸¤ä¸ªtableéƒ½å­˜äº†é“¾è¡¨çš„å¤´ç»“ç‚¹ï¼ˆé€šè¿‡è°ƒè¯•å¯ä»¥æ¸…æ¥šçœ‹åˆ°ï¼‰
        //åŸå› ï¼šè¿™é‡ŒæŠŠæ—§è¡¨æ•°æ®æ‹·è´åˆ°æ–°è¡¨å…¶å®å°±æ˜¯å•é“¾è¡¨çš„æ‹·è´ï¼Œä½†æ˜¯æ‹·è´åæ—§è¡¨ä¾ç„¶è®°ä½äº†ä¸€ä¸ªç»“ç‚¹ï¼ˆæ‹·è´è¿‡ç¨‹ä¸­æ²¡æœ‰æ“ä½œæ—§è¡¨çš„vectorï¼Œæ‰€ä»¥æ—§è¡¨vectorå­˜çš„Node*æ²¡å˜,ä¸è¿‡å¤´ç»“ç‚¹æŒ‡é’ˆæŒ‡å‘çš„Nodeé‡Œé¢çš„_nextè¢«ç½®ä¸ºç©ºäº†ï¼Œå› ä¸ºæ—§è¡¨æ¯ä¸ªæ¡¶çš„å¤´ç»“ç‚¹æ‹·è´è¿‡å»éƒ½ä¼šæ˜¯æ–°è¡¨çš„æœ€åä¸€ä¸ªç»“ç‚¹ï¼ˆå¤´æ’ï¼‰ï¼‰ï¼Œæ‰€ä»¥æ—§è¡¨æ‹·è´å‰åéƒ½æ˜¯è®°ä½äº†æ¯ä¸ªé“¾è¡¨çš„å¤´ç»“ç‚¹çš„ï¼Œå› æ­¤æ—§è¡¨æ¯ä¸ªæ¡¶æœ€å¤šåªæœ‰ä¸€ä¸ªå¤´ç»“ç‚¹
	}
			
	size_t index = hash(kv.first) % _tables.size();//ç®—å‡ºæ¡¶å·
	//å¤´æ’
	Node* newNode = new Node(kv);
	newNode->_next = _tables[index];
	_tables[index]=newNode;
	++_n;//åˆ«å¿˜è®°æ›´æ–°æœ‰æ•ˆæ•°æ®çš„ä¸ªæ•°
	return true;
}
```

>æ€è€ƒnewTableå­˜åœ¨å†…å­˜æ³„æ¼å—ï¼Ÿ
>
>newTableç”Ÿå‘½å‘¨æœŸç»“æŸåè°ƒç”¨è‡ªå·±çš„ææ„å‡½æ•°ï¼ŒnewTableäº¤æ¢åæ¯æ¡é“¾è¡¨æœ€å¤šä¸€ä¸ªç»“ç‚¹ï¼Œæ‰€ä»¥é»˜è®¤çš„ç»“ç‚¹çš„ææ„å°±å¤Ÿç”¨ã€‚æ³¨æ„ï¼šäº¤æ¢åä¸¤ä¸ªtableéƒ½å­˜äº†é“¾è¡¨çš„å¤´ç»“ç‚¹ï¼ˆé€šè¿‡è°ƒè¯•å¯ä»¥æ¸…æ¥šçœ‹åˆ°ï¼‰
>
>> ä¸ºå•¥newTableäº¤æ¢åæ¯æ¡é“¾è¡¨æœ€å¤šä¸€ä¸ªç»“ç‚¹ï¼Ÿæˆ–è€…è¯´æ‹·è´åã€äº¤æ¢å‰çš„æ—§è¡¨æ¯æ¡é“¾è¡¨æœ€å¤šä¸€ä¸ªç»“ç‚¹
>>
>> åŸå› ï¼šè¿™é‡ŒæŠŠæ—§è¡¨æ•°æ®æ‹·è´åˆ°æ–°è¡¨å…¶å®å°±æ˜¯å•é“¾è¡¨çš„æ‹·è´ï¼Œä½†æ˜¯æ‹·è´åæ—§è¡¨ä¾ç„¶è®°ä½äº†ä¸€ä¸ªç»“ç‚¹ï¼ˆæ‹·è´è¿‡ç¨‹ä¸­æ²¡æœ‰æ“ä½œæ—§è¡¨çš„vectorï¼Œæ‰€ä»¥æ—§è¡¨vectorå­˜çš„Node*æ²¡å˜,ä¸è¿‡å¤´ç»“ç‚¹æŒ‡é’ˆæŒ‡å‘çš„Nodeé‡Œé¢çš„_nextè¢«ç½®ä¸ºç©ºäº†ï¼Œå› ä¸ºæ—§è¡¨æ¯ä¸ªæ¡¶çš„å¤´ç»“ç‚¹æ‹·è´è¿‡å»éƒ½ä¼šæ˜¯æ–°è¡¨çš„æœ€åä¸€ä¸ªç»“ç‚¹ï¼ˆå¤´æ’ï¼‰ï¼‰ï¼Œæ‰€ä»¥æ—§è¡¨æ‹·è´å‰åéƒ½æ˜¯è®°ä½äº†æ¯ä¸ªé“¾è¡¨çš„å¤´ç»“ç‚¹çš„ï¼Œå› æ­¤æ—§è¡¨æ¯ä¸ªæ¡¶æœ€å¤šåªæœ‰ä¸€ä¸ªå¤´ç»“ç‚¹

æ’å…¥æ—¶çš„æ•ˆç‡å˜åŒ–

![image-20220522190106496](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220522190106496.png)



#### ğŸŒµåˆ é™¤

æ€è·¯ï¼šå…ˆçœ‹è¿™ä¸ªå…ƒç´ å­˜ä¸å­˜åœ¨ï¼Œä¸å­˜åœ¨ç›´æ¥è¿”å›falseã€‚å­˜åœ¨çš„è¯ç®—å‡ºæ¡¶å·è½¬ä¸ºå•é“¾è¡¨çš„åˆ é™¤ã€‚

> å•é“¾è¡¨çš„åˆ é™¤åˆ†ä¸ºæ˜¯å¦æ˜¯å¤´ç»“ç‚¹ï¼Œå…ˆæ‰¾åˆ°è¿™ä¸ªå…ƒç´ å†çœ‹æ˜¯ä¸æ˜¯å¤´ç»“ç‚¹
>
> ä¸ºä»€ä¹ˆä¸ç›´æ¥Find()æ‰¾åˆ°è¿™ä¸ªç»“ç‚¹ç›´æ¥åˆ é™¤ï¼Ÿå•é“¾è¡¨åˆ é™¤éœ€è¦å€ŸåŠ©åˆ é™¤ç»“ç‚¹çš„å‰ä¸€ä¸ªç»“ç‚¹ï¼ŒFindåªèƒ½æ‰¾åˆ°å½“å‰ç»“ç‚¹ã€‚æ‰€ä»¥åˆ é™¤æ²¡æœ‰å¤ç”¨Find().

```c++
bool Erase(const K& key)
{ 
	//if (!Find(key))//æ‰¾ä¸åˆ°è¿™ä¸ªå…ƒç´  
	// è¿™ä¹ˆå†™ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯åé¢åˆ é™¤çš„è¿‡ç¨‹ä¸­ä¼šé¡ºå¸¦éå†æ•´ä¸ªæ¡¶
	//{
	//	return false;
	//}
	if (_tables.size() == 0)//å“ˆå¸Œè¡¨ä¸ºç©º
	{
		return false;
	}
	Hash hash;
	size_t index = hash(key) % _tables.size();
	Node* cur = _tables[index];
	Node* prev = nullptr;//è®°å½•å‰ä¸€ä¸ªä½ç½®
	while (cur)
	{
		if (cur->_kv.first == key)//æ‰¾åˆ°è¿™ä¸ªå…ƒç´ äº†
		{
			if(cur==_tables[index])//å…ƒç´ æ˜¯å¤´ç»“ç‚¹
			{
				_tables[index] = cur->_next;
						
			}
			else//ä¸æ˜¯å¤´ç»“ç‚¹
			{
				prev->_next = cur->_next;
			}
			delete cur;
			cur = nullptr;
			_n--;
			return true;
		}
		else
		{
			prev = cur;
			cur = cur->_next;
		}
	}
	return false;
}
```



#### ğŸŒµææ„

åˆ¤æ–­æ¡¶çš„å¤´ç»“ç‚¹æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºè¯´æ˜æ²¡æœ‰ç»“ç‚¹ç›´æ¥ä¸‹ä¸€ä¸ªï¼Œæœ‰çš„è¯ä»ç¬¬äºŒä¸ªå¼€å§‹éå†é“¾è¡¨åˆ é™¤

> ä¸ºä»€ä¹ˆä¸ä»ç¬¬ä¸€ä¸ªåˆ é™¤
>
> ç¬¬ä¸€ä¸ªçš„åˆ é™¤äº¤ç»™vectorï¼Œå¦‚æœä»ç¬¬ä¸€ä¸ªå¼€å§‹ä¼šé€ æˆåŒä¸€ä¸ªå…ƒç´ ææ„ä¸¤æ¬¡ï¼Œç¨‹åºä¼šå´©...

```c++
~HashTable()//å“ˆå¸Œæ¡¶é‡‡ç”¨çš„é“¾è¡¨ç»“æ„ éœ€è¦é‡Šæ”¾æ¯ä¸ªé“¾è¡¨
{
	for (int i=0;i<_tables.size();i++)
	{
		Node* cur = _tables[i];
		if (cur == nullptr)
		{
			continue;
		}
		else
		{
			cur = cur->_next;//ä¸ä¸ºç©ºä»ç¬¬äºŒä¸ªå¼€å§‹
		}
		while (cur)
		{
			Node* next = cur->_next;
			delete cur;
			cur = next;
		}
		_tables[i] = nullptr;
	}
	_n = 0;
}
```

#### ğŸŒµæ‹·è´æ„é€ å’Œèµ‹å€¼é‡è½½

> æ‹·è´æ„é€ å’Œèµ‹å€¼é‡è½½éƒ½è¦æ‹·è´å‡ºå®Œå…¨ç›¸åŒçš„ä¸€ä»½ï¼Œæ‰€ä»¥éœ€è¦å°¾æ’ï¼Œç”±äºå•é“¾è¡¨å°¾æ’éœ€è¦æ‰¾å°¾ï¼Œæ•ˆç‡ä¸é«˜ã€‚æ‰€ä»¥æ²¡æœ‰å®ç°ï¼Œç½‘ä¸Šæ‰¾çš„èµ„æºä¹Ÿæ²¡æ‰¾åˆ°ç­”æ¡ˆã€‚é˜…è¯»STLæºç çš„èƒ½åŠ›è¿˜ä¸å¤Ÿï¼Œæ‰€ä»¥æ‰“ç®—ä»¥åçœ‹æºç æ€ä¹ˆå®ç°æ‹·è´æ„é€ çš„ã€‚

![image-20220522185820586](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220522185820586.png)

 #### ğŸŒµä¼˜åŒ–

å“ˆå¸Œè¡¨çš„å¤§å°å»ºè®®æ˜¯ç´ æ•°ï¼Œç½‘ä¸Šæœ‰å¤§ä½¬å¯ä»¥æ¢è®¨è¿‡äº†ï¼Œè¿™é‡Œç›´æ¥è´´ä¸€ä¸‹ç½‘ä¸Šçš„ä»£ç ã€‚

> ç´ æ•°çš„è¯é™¤ç•™ä½™æ•°æ³•æ—¶å“ˆå¸Œå†²çªçš„å¯èƒ½æ€§æ›´å°

```c++
		size_t GetNextPrime(size_t prime)
		{
			const int PRIMECOUNT = 28;
			static const size_t primeList[PRIMECOUNT] =
			{
				53ul, 97ul, 193ul, 389ul, 769ul,
				1543ul, 3079ul, 6151ul, 12289ul, 24593ul,
				49157ul, 98317ul, 196613ul, 393241ul, 786433ul,
				1572869ul, 3145739ul, 6291469ul, 12582917ul, 25165843ul,
				50331653ul, 100663319ul, 201326611ul, 402653189ul, 805306457ul,
				1610612741ul, 3221225473ul, 4294967291ul
			};
			//ulè¡¨ç¤ºunsigned long
			size_t i = 0;
			for (; i < PRIMECOUNT; ++i)
			{
				if (primeList[i] > prime)
					return primeList[i];
			}

			return primeList[i];
		}
```

![image-20220522191635309](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220522191635309.png)



## ğŸŒ´æ€»ç»“

å“ˆå¸Œè¡¨çš„ç»“æ„æŒæ¡åï¼Œå¤„ç†å“ˆå¸Œå†²çªå³å¯ã€‚å¤„ç†å“ˆå¸Œå†²çªçš„æ–¹å¼ä¸åŒä¼šå¯¼è‡´å“ˆå¸Œè¡¨çš„æ•ˆç‡ä¸åŒã€‚





 

