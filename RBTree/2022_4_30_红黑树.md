[toc]

# ğŸŒ²çº¢é»‘æ ‘

> å­¦çº¢é»‘æ ‘ä¹‹å‰é»˜è®¤ä½ å·²ç»ç†Ÿæ‚‰äº†äºŒå‰æœç´¢æ ‘å’ŒAVLæ ‘
>
> ![image-20220505204052302](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505204052302.png)

## ğŸŒ´æ¦‚å¿µ

### ğŸŒµä»€ä¹ˆæ˜¯çº¢é»‘æ ‘ï¼Ÿ

>çº¢é»‘æ ‘ï¼ˆRed Black Treeï¼‰ æ˜¯ä¸€ç§è‡ªå¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œæ˜¯åœ¨[è®¡ç®—æœº](https://baike.baidu.com/item/è®¡ç®—æœº)ç§‘å­¦ä¸­ç”¨åˆ°çš„ä¸€ç§[æ•°æ®ç»“æ„](https://baike.baidu.com/item/æ•°æ®ç»“æ„/1450)ï¼Œå…¸å‹çš„ç”¨é€”æ˜¯å®ç°[å…³è”æ•°ç»„](https://baike.baidu.com/item/å…³è”æ•°ç»„/3317025)ã€‚ [1] 
>
>çº¢é»‘æ ‘æ˜¯åœ¨1972å¹´ç”±[Rudolf Bayer](https://baike.baidu.com/item/Rudolf Bayer/3014716)å‘æ˜çš„ï¼Œå½“æ—¶è¢«ç§°ä¸ºå¹³è¡¡äºŒå‰Bæ ‘ï¼ˆsymmetric binary B-treesï¼‰ã€‚åæ¥ï¼Œåœ¨1978å¹´è¢« Leo J. Guibas å’Œ Robert Sedgewick ä¿®æ”¹ä¸ºå¦‚ä»Šçš„â€œçº¢é»‘æ ‘â€ã€‚ [2] 
>
>çº¢é»‘æ ‘æ˜¯ä¸€ç§ç‰¹åŒ–çš„AVLæ ‘ï¼ˆ[å¹³è¡¡äºŒå‰æ ‘](https://baike.baidu.com/item/å¹³è¡¡äºŒå‰æ ‘/10421057)ï¼‰ï¼Œéƒ½æ˜¯åœ¨è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œæ—¶é€šè¿‡ç‰¹å®šæ“ä½œä¿æŒäºŒå‰æŸ¥æ‰¾æ ‘çš„å¹³è¡¡ï¼Œä»è€Œè·å¾—è¾ƒé«˜çš„æŸ¥æ‰¾æ€§èƒ½ã€‚ [2] 
>
>å®ƒè™½ç„¶æ˜¯å¤æ‚çš„ï¼Œä½†å®ƒçš„æœ€åæƒ…å†µè¿è¡Œæ—¶é—´ä¹Ÿæ˜¯éå¸¸è‰¯å¥½çš„ï¼Œå¹¶ä¸”åœ¨å®è·µä¸­æ˜¯é«˜æ•ˆçš„ï¼š å®ƒå¯ä»¥åœ¨O(log n)æ—¶é—´å†…åšæŸ¥æ‰¾ï¼Œæ’å…¥å’Œåˆ é™¤ï¼Œè¿™é‡Œçš„n æ˜¯æ ‘ä¸­å…ƒç´ çš„æ•°ç›®ã€‚ [2] -- ç™¾åº¦ç™¾ç§‘

ç®€å•æ¥è¯´ï¼Œåœ¨äºŒå‰æœç´¢æ ‘çš„åŸºç¡€ä¸ŠåŠ äº†çº¢é»‘ä¸¤ç§é¢œè‰²ï¼Œé€šè¿‡é¢œè‰²çš„è°ƒæ§å¯ä»¥æ§åˆ¶æ ‘çš„é«˜åº¦ï¼Œç”±æ­¤æé«˜äº†æŸ¥æ‰¾æ•ˆç‡ã€‚

> äºŒå‰æœç´¢æ ‘çš„ç¼ºé™·åœ¨äºåœ¨æœ€åæƒ…å†µä¸‹æŸ¥æ‰¾çš„æ•ˆç‡æ˜¯O(N)ï¼Œè¿™ä¸€ç‚¹éƒ½ä¸ä¼˜é›…ğŸ˜³ï¼Œè€Œçº¢é»‘æ ‘è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œæœ€åçš„æƒ…å†µä¸‹çº¢é»‘æ ‘çš„æŸ¥æ‰¾æ•ˆç‡ä¾æ—§æ˜¯O(logn)ï¼

### ğŸŒµçº¢é»‘æ ‘çš„æ€§è´¨

1. æ¯ä¸ªç»“ç‚¹é¢œè‰²ä¸æ˜¯çº¢è‰²å°±æ˜¯é»‘è‰²
2. æ ¹èŠ‚ç‚¹æ˜¯é»‘è‰²
3. å¦‚æœä¸€ä¸ªç»“ç‚¹æ˜¯çº¢è‰²ï¼Œåˆ™å®ƒçš„ä¸¤ä¸ªå­©å­ç»“ç‚¹å¿…ä¸ºé»‘ï¼ˆå³ä¸€æ¡è·¯å¾„ä¸Šä¸ä¼šæœ‰ä¸¤ä¸ªè¿ç»­çš„çº¢ï¼‰
4. æ¯ä¸ªç»“ç‚¹ï¼Œä»è¯¥èŠ‚ç‚¹åˆ°å¶å­ç»“ç‚¹çš„ç®€å•è·¯å¾„ä¸Šï¼Œå‡åŒ…å«ç›¸åŒæ•°ç›®çš„é»‘è‰²ç»“ç‚¹
5. æ¯ä¸ªå¶å­ç»“ç‚¹éƒ½æ˜¯é»‘è‰²çš„ï¼ˆæ­¤å¤„çš„å¶å­æ˜¯æŒ‡ç©ºç»“ç‚¹ï¼‰

**<font color= #1E90FF>æ€è€ƒä¸‹é¢çš„é—®é¢˜</font>**

- ç¬¬ä¸‰æ¡å’Œç¬¬å››æ¡æ€§è´¨ä¸ºä»€ä¹ˆå¯ä»¥æ¨å‡ºæœ€é•¿è·¯å¾„ä¼šå°äºç­‰äºæœ€çŸ­è·¯å¾„çš„ä¸¤å€ï¼Ÿ

å› ä¸ºç†è®ºä¸Šçº¢é»‘æ ‘ä¸­æœ€çŸ­è·¯å¾„å…¨é»‘ï¼Œæœ€é•¿è·¯å¾„ä¸¤ä¸ªé»‘ä¹‹é—´å¤¹ä¸€ä¸ªçº¢

![image-20220504203441369](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220504203441369.png)

> æ­£å› ä¸ºæœ€é•¿è·¯å¾„<=2*æœ€çŸ­è·¯å¾„ï¼Œç”±æ­¤å°±æ§åˆ¶äº†æ ‘çš„é«˜åº¦ï¼Œä¹Ÿè¯´æ˜çº¢é»‘æ ‘ä¸åƒAVLæ ‘é‚£æ ·ä¸¥æ ¼å¹³è¡¡ï¼Œå…¶å®å¯ä»¥é€šè¿‡è®¡ç®—å¯çŸ¥AVLæ ‘çš„å…·ä½“æŸ¥æ‰¾æ•ˆç‡æ˜¯logn,çº¢é»‘æ ‘çš„å…·ä½“æŸ¥æ‰¾æ•ˆç‡æ˜¯2lognï¼Œlognå’Œ2lognçš„æ•ˆç‡ç›¸å·®ä¸å¤§ã€‚å‡è®¾æ•°æ®è§„æ¨¡nä¸ºåäº¿ï¼Œlognä¹Ÿå°±ç­‰äº30å·¦å³ï¼Œ2lognä¹Ÿå°±æ˜¯60,å¯¹äºç°åœ¨çš„CPUæ¥è¯´åŸºæœ¬ä¸Šæ²¡å•¥å·®åˆ«ï¼Œä½†æ˜¯æ„é€ çº¢é»‘æ ‘çš„ä»£ä»·ï¼ˆæ—‹è½¬æ¬¡æ•°ï¼‰å´ä¼šæ¯”æ„é€ AVLæ ‘ä½å¾ˆå¤šï¼Œç”±æ­¤æˆ‘ä»¬å¯çŸ¥çº¢é»‘æ ‘çš„æ•ˆç‡å…¶å®æ˜¯æ¯”AVLæ ‘é«˜çš„ã€‚

- ç¬¬äº”æ¡æ€§è´¨è¯´çš„æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ

![image-20220504204058091](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220504204058091.png)

- çº¢è‰²ç»“ç‚¹çš„å­©å­å¿…å®šæ˜¯é»‘è‰²ç»“ç‚¹ï¼Œç¡®ä¿äº†çº¢é»‘ç›¸é—´ï¼Œæ‰€ä»¥å¯ä»¥æœ‰è¿ç»­é»‘ï¼Œä½†ä¸å¯èƒ½æœ‰è¿ç»­çº¢


## ğŸŒ´æ’å…¥

### ğŸŒµé“ºå«

- çº¢é»‘æ ‘æ˜¯åœ¨äºŒå‰æœç´¢æ ‘çš„åŸºç¡€ä¸Šï¼Œç”±äºŒå‰æœç´¢æ ‘çš„çŸ¥è¯†å¯çŸ¥æ’å…¥çš„ä½ç½®è‚¯å®šæ˜¯åœ¨ç©ºèŠ‚ç‚¹çš„ä½ç½®ï¼ˆä¹Ÿå°±æ˜¯çš„åœ¨å¶å­çš„ä¸‹ä¸€ä¸ªä½ç½®ï¼‰

- æ–°å¢èŠ‚ç‚¹çš„é¢œè‰²ä¸ºä»€ä¹ˆæ˜¯çº¢è‰²ï¼Ÿ

å‡å¦‚æŠŠæ–°å¢èŠ‚ç‚¹çš„é¢œè‰²è®¾ç½®ä¸ºé»‘è‰²ï¼Œé‚£ä¼šå¯¼è‡´æ¯æ¡è·¯å¾„çš„é»‘è‰²ç»“ç‚¹æ•°ç›®ä¸åŒï¼ˆæ€§è´¨4ï¼‰ï¼Œè°ƒæ•´èµ·æ¥ä»£ä»·å¾ˆå¤§ï¼Œå¦‚æœæŠŠæ–°å¢ç»“ç‚¹è®¾ä¸ºçº¢è‰²ï¼Œå°±å¥½å¤„ç†å¾ˆå¤šï¼Œå› ä¸ºæ’å…¥çº¢è‰²ç»“ç‚¹åªéœ€è€ƒè™‘ä¸è¦å‡ºç°è¿ç»­çš„çº¢è‰²ç»“ç‚¹ï¼ˆæ€§è´¨ä¸‰ï¼‰ã€‚

> ç†è®ºä¸ŠæŠŠæ–°å¢ç»“ç‚¹è®¾ä¸ºé»‘è‰²ä¹Ÿå¯ä»¥è°ƒæ•´ï¼Œä½†æ˜¯æ•ˆç‡è‚¯å®šä¼šæ¯”çº¢è‰²æ›´ä½ã€‚~~å› ä¸ºåœ¨çº¢é»‘æ ‘çš„åˆ é™¤ä¸­ï¼Œæœ€éº»çƒ¦çš„å°±æ˜¯åˆ é™¤åæ¯æ¡è·¯å¾„çš„é»‘è‰²ç»“ç‚¹æ•°ä¸åŒ~~

- è®°ä½ä¸‹é¢å„ä¸ªç»“ç‚¹çš„è¡¨ç¤ºç¬¦å·

![image-20220504210536703](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220504210536703.png)

> grandfatherä»…ä»…æ˜¯ä¸€é¢—å­æ ‘çš„æ ¹ï¼Œä¸ä¸€å®šæ˜¯æ•´æ£µæ ‘çš„æ ¹

- æˆ‘ä¸ªäººæŠŠä¸€æ£µ**åˆæ ¼çš„**çº¢é»‘æ ‘æ—‹è½¬å‰çš„çŠ¶æ€æˆä¸ºåˆçŠ¶æ€/åˆæ€ï¼ˆè¿™ä¸ªæ˜¯æˆ‘ç¼–çš„ï¼Œä¸ºäº†åé¢æ›´å¥½æè¿°ğŸ¤ªï¼‰

### ğŸŒµæ’å…¥çš„å„ç§æƒ…å†µ

[æµç¨‹å›¾é«˜æ¸…å›¾ç‰‡](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505150554662.png)

```mermaid
graph LR
X(curä¸ºé»‘)-->Y(ä¸åˆç†)
A(curä¸ºçº¢)--parentä¸ºé»‘-->B(ä¸å¤„ç†)

A--parentä¸ºçº¢-->C(çœ‹uncle)
C--uncleä¸ºçº¢-->D(å˜è‰²+é€’å½’)

D--grandfatherçš„çˆ¶äº²ä¸ºçº¢-->F(å‘ä¸Šé€’å½’)
D--grandfatherçš„çˆ¶äº²ä¸ºé»‘-->G(è°ƒæ•´ç»“æŸ)
B-->G
F--è°ƒæ•´è‡³çˆ¶äº²ä¸ºé»‘/è°ƒæ•´è‡³æ ¹èŠ‚ç‚¹-->G
C--uncleä¸ºé»‘/ä¸å­˜åœ¨-->E(æ—‹è½¬+å˜è‰²)
E--cur,parent,grandfatheråœ¨ä¸€æ¡ç›´çº¿ä¸Š-->I(å•æ—‹+å˜è‰²)
E--cur,parent,grandfatheråœ¨ä¸€æ¡æŠ˜çº¿ä¸Š-->J(åŒæ—‹+å˜è‰²)
I-->G
J-->G
```



1. **<font color= #40E0D0>parentä¸ºé»‘,uncleå’Œgrandfatheréšæ„</font>**

**å¤„ç†**ï¼šä¸åšå¤„ç†ã€‚å¯çŸ¥æ’å…¥æ–°å¢ç»“ç‚¹ä»ç„¶æ˜¯ä¸€æ£µåˆæ ¼çš„çº¢é»‘æ ‘

ä¸‹é¢åˆ—å‡ºparentä¸ºé»‘æ—¶çš„å„ç§æƒ…å†µ

![image-20220504210536703](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220504210536703.png)

![image-20220504211225118](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220504211225118.png)

![image-20220504211441521](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220504211441521.png)



2. **<font color= #40E0D0>parentä¸ºçº¢è‰²ç»“ç‚¹ï¼Œgrandfatherä¸ºé»‘ï¼Œuncleæœªå®š</font>**

> parentä¸ºçº¢ï¼Œgrandparentå¿…ä¸ºé»‘(çº¢é»‘ç›¸é—´çš„æ€§è´¨)ï¼Œæ­¤æ—¶çš„å¤„ç†å–å†³äºuncle
>
> æœ¬è´¨ä¸Šå°±æ˜¯åœ¨å¤„ç†åŒçº¢(è¿ç»­çš„çº¢ç»“ç‚¹)çš„æƒ…å†µ

2.1 uncleä¸ºçº¢

å¤„ç†ï¼šparentå’Œuncleå˜é»‘ï¼Œgrandparentå˜çº¢ï¼Œå†æŠŠcuræŒ‡é’ˆæŒ‡å‘grandparentå‘ä¸Šé€’å½’å¤„ç†

**æŠ½è±¡å›¾**

![image-20220504214143104](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220504214143104.png)

**å…·ä½“å›¾**

![image-20220504212247983](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220504212247983.png)



> éšç¬”è®°å½•ï¼šæ­¤æ—¶åªéœ€è¦å˜è‰²ä¸éœ€è¦æ—‹è½¬ï¼ˆä¸‹é¢pè¡¨ç¤ºparentï¼Œuè¡¨ç¤ºuncleï¼Œgè¡¨ç¤ºgrandfatherï¼‰
>
> på’Œuéƒ½å¤„ç†ä¸ºé»‘ï¼Œgå¤„ç†ä¸ºçº¢  è¿™æ¡è·¯å¾„æœ¬æ¥å°±æ˜¯ä¸€é»‘ ï¼Œå¤„ç†åä¾æ—§æ˜¯ä¸€é»‘ï¼Œè‹¥æ˜¯gå¤„ç†ä¸ºçº¢åï¼Œ**gçš„çˆ¶äº²ä¹Ÿæ˜¯çº¢ï¼Œåˆ™ä»ç„¶å­˜åœ¨ä¸¤ä¸ªè¿ç»­çš„çº¢ï¼Œåˆ™ç»§ç»­å¤„ç†**
>
> çº¢å˜é»‘==å¢åŠ ä¸€ä¸ªé»‘è‰²ç»“ç‚¹
>
> é»‘å˜çº¢==å‡å°‘ä¸€ä¸ªé»‘è‰²ç»“ç‚¹ï¼Œè€ƒè™‘æ˜¯å¦ä¼šå‡ºç°è¿ç»­çš„äºŒçº¢

2.2 uncleä¸ºé»‘/ä¸å­˜åœ¨

> **<font color=red>è¿™ç§æƒ…å†µè‚¯å®šä¸æ˜¯åˆçŠ¶æ€ï¼Œæ˜¯ç”±æƒ…å†µ2.1å˜æ¥çš„</font>**
>
> åŸå› ï¼š![image-20220504220446361](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220504220446361.png)
>
> ä¸­é—´çŠ¶æ€å¯èƒ½æ˜¯æƒ…å†µ2.1å‘ä¸Šé€’å½’å‡ºç°çš„å…¶ä¸­ä¸€ç§æƒ…å†µ

2.2.1 grandfatherã€parentã€curåœ¨ä¸€æ¡ç›´çº¿ä¸Š

å¤„ç†ï¼šå•æ—‹+å˜è‰²

![image-20220504223328351](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220504223328351.png)

<font color=red>**æŠ½è±¡å›¾**</font>ï¼š[é«˜æ¸…å›¾ç‰‡](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220504222653793.png)

**<font color= #40E0D0>ç¬¬ä¸€æ­¥ï¼šå•æ—‹</font>**

![image-20220504222933165](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220504222933165.png)

**<font color= #40E0D0>ç¬¬äºŒæ­¥ï¼šå˜è‰²</font>**

![image-20220504223013265](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220504223013265.png)

> è¿™æ˜¯æ–°å¢ç»“ç‚¹åœ¨å·¦å­æ ‘çš„æƒ…å†µï¼Œé‚£åœ¨å³å­æ ‘å‘¢ï¼Ÿå¯ä»¥è‡ªå·±å°è¯•ç”»å›¾å®ç°

2.2.2 grandfatherã€parentã€curåœ¨ä¸€æ¡æŠ˜çº¿ä¸Š

å¤„ç†ï¼šåŒæ—‹+å˜è‰²

![image-20220504224026003](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220504224026003.png)

<font color=red>**æŠ½è±¡å›¾**</font>(å‡è®¾curåœ¨grandfatherçš„å·¦å­æ ‘)

**<font color= #40E0D0>ç¬¬ä¸€æ­¥ï¼šä»¥parentä¸ºè½´å·¦æ—‹</font>**

![image-20220504224638765](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220504224638765.png)

**<font color= #40E0D0>ç¬¬äºŒæ­¥ï¼šä»¥grandfatherä¸ºè½´å³æ—‹</font>**

![image-20220504224812489](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220504224812489.png)

**<font color= #40E0D0>ç¬¬ä¸‰æ­¥ï¼šå˜è‰²</font>**

![image-20220504224907571](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220504224907571.png)

> è¿™æ˜¯curåœ¨grandfatehrçš„å·¦å­æ ‘ä¸”ä¸ºæŠ˜çº¿çš„æƒ…å†µï¼Œå¯ä»¥è‡ªå·±å°è¯•ç”»å‡ºcuråœ¨å³å­æ ‘ä¸”ä¸ºæŠ˜çº¿çš„çŠ¶æ€
>
> éšç¬”è®°å½•ï¼š
>
> - å¦‚ä½•å¤„ç†ï¼Ÿæ—‹è½¬+å˜è‰² ï¼›pä¸€å®šè¦ä»çº¢å˜ä¸ºé»‘ï¼› gä¸ºé»‘ï¼Œuä¸ºé»‘è½¬åˆ°ä¸‹é¢å»,å†æŠŠpç”±çº¢è½¬é»‘ï¼Œgå’Œuè½¬åˆ°ä¸‹é¢å»åé»‘è‰²ç»“ç‚¹æ•°ç›®æœ¬æ¥æ˜¯æ²¡å˜çš„ï¼Œä½†æ˜¯å› ä¸ºpæ˜¯ç¥–çˆ¶å˜è‰²äº†ï¼Œå½±å“äº†è¿™æ£µå­æ ‘ï¼Œå°±å¾—æŠŠuç”±é»‘è½¬çº¢å®ç°çº¢é»‘æ ‘çš„å¹³è¡¡
>
> - ç¬¬äºŒç§æƒ…å†µå¯ä»¥ç›´æ¥breakäº†ï¼Œç¬¬äºŒç§æƒ…å†µæ—‹è½¬å˜è‰²å®Œcurå‡ºç°åœ¨æœ€ä¸Šé¢ä¸ºé»‘è‰²ï¼Œä¸å¿…ç»§ç»­æ›´æ–°ã€‚
>
> - å…¶ä¸­uncleä¸å­˜åœ¨ï¼Œå°±å½“åšä¸ºç©ºå»å†™ï¼Œå› ä¸ºrotateRå’ŒrotateLå·²ç»å¯¹uncleä¸ºç©ºè¿›è¡Œäº†å¤„ç†ï¼Œæ‰€ä»¥ä»£ç å®ç°æ—¶ä¸ä¼šå‡ºç°ç©ºæŒ‡é’ˆè§£å¼•ç”¨çš„æƒ…å†µ
>
> - ä¸ç®¡æ˜¯å•æ—‹è¿˜æ˜¯åŒæ—‹ï¼Œgrandfatheréƒ½è¢«è½¬åˆ°ä¸‹é¢å»äº†ï¼Œé¢œè‰²éƒ½è¢«ç½®ä¸ºçº¢è‰²ï¼Œå†æŠŠæ—‹è½¬åçš„æ ¹ç½®ä¸ºé»‘è‰².
>
> ~~æ„Ÿè§‰ä¸Šï¼Œæ ¹èŠ‚ç‚¹ç½®ä¸ºé»‘è‰²æ›´å¥½æ§åˆ¶å¹³è¡¡ï¼Œå¤šç”»å‡ ä¸ªå›¾ä¼šæœ‰è¿™ç§æ„Ÿè§‰...~~



### ğŸŒµçº¢é»‘æ ‘ç»“ç‚¹

- æšä¸¾ä½“ä¿è¯æ€§è´¨ä¸€ ä¸€å®šæˆç«‹
- ä¸‰å‰é“¾ç»“æ„ï¼Œå’ŒäºŒå‰æœç´¢æ ‘ä¸€æ ·
- æ’å…¥çš„æ˜¯KVé”®å€¼å¯¹ï¼Œæ ¹æ®Kå€¼æ’åº
- ææ„å‡½æ•°é˜²æ­¢å†…å­˜æ³„æ¼ï¼ˆåˆ é™¤è¿‡ç¨‹ä¸­æœ‰ç”¨ï¼‰

```c++
enum Color
{
	RED,
	BLACK
};
template<class K,class V>
struct RBTreeNode
{
	RBTreeNode* _left;
	RBTreeNode* _right;
	RBTreeNode* _parent;

	pair<K, V>_kv;
	int _col;

	RBTreeNode(const pair<K,V>&kv)
		:_left(nullptr)
		,_right(nullptr)
		,_parent(nullptr)
		,_kv(kv)
		,_col(RED)
	{}
	~RBTreeNode()
	{
		_left = nullptr;
		_right = nullptr;
		_parent = nullptr;
		_col = BLACK;
	}
};
```

### ğŸŒµä»£ç å®ç°

```c++
template<class K,class V>
class RBTree
{
	typedef RBTreeNode<K,V> Node;
public:
	RBTree()
		:_root(nullptr)
	{}
    
	bool Insert(const pair<K, V>& kv)
	{
		if (_root == nullptr)
		{
			_root = new Node(kv);
			_root->_col = BLACK;
			return true;
		}
		Node* cur = _root;
		Node* parent = nullptr;
		while (cur)
		{
			if (kv.first < (cur->_kv).first)
			{
				parent = cur;
				cur = cur->_left;
			}
			else if (kv.first > (cur->_kv).first)
			{
				parent = cur;
				cur = cur->_right;
			}
			else//å­˜åœ¨ç›¸åŒå€¼
			{
				return false;
			}
		}
		cur = new Node(kv);
		if ((cur->_kv).first < (parent->_kv).first)
		{
			parent->_left = cur;
		}
		else
		{
			parent->_right = cur;
		}
		cur->_parent = parent;

		//å¼€å§‹å¤„ç†çº¢é»‘å› å­
		while (parent && parent->_col == RED)
		{
			_root->_col = BLACK;
			Node* grandfather = parent->_parent;
			if (parent == grandfather->_left)//çˆ¶äº²æ˜¯å·¦å­©å­ ä¸ºäº†åˆ¤æ–­æ˜¯ç›´çº¿è¿˜æ˜¯æŠ˜çº¿  ä¸€å…±æœ‰å››ç§å¯èƒ½
			{
				Node* uncle = grandfather->_right;
				if (uncle && uncle->_col == RED)//uncleå­˜åœ¨ä¸”ä¸ºçº¢
				{
					grandfather->_col = RED;
					parent->_col = uncle->_col = BLACK;
					cur = grandfather;
					parent = cur->_parent;
				}
				else //uncleä¸å­˜åœ¨æˆ–è€…uncleä¸ºé»‘
				{
					if (parent->_left == cur)//ç›´çº¿
					{
						RotateR(grandfather);
						parent->_col = BLACK;
						grandfather->_col = RED;
					}
					else//æŠ˜çº¿
					{
						RotateL(parent);
						RotateR(grandfather);
						grandfather->_col = RED;
						cur->_col = BLACK;
					}
					break;
				}
			}
			else//çˆ¶äº²æ˜¯å³å­©å­
			{
				Node* uncle = grandfather->_left;
				if (uncle && uncle->_col == RED)
				{
					parent->_col = uncle->_col = BLACK;
					grandfather->_col = RED;
					cur = grandfather;
					parent = cur->_parent;//è¿­ä»£
				}
				else//uncleä¸å­˜åœ¨æˆ–uncleä¸ºé»‘
				{
					if (parent->_right == cur)
					{
						RotateL(grandfather);
						parent->_col = BLACK;
						grandfather->_col = RED;
					}
					else//æŠ˜çº¿
					{
						RotateR(parent);
						RotateL(grandfather);
						cur->_col = BLACK;
						grandfather->_col = RED;
					}
					break;
				}
			}
		}
		_root->_col = BLACK;
		return true;
	}

	void RotateR(Node* parent)//å³æ—‹
	{
        //subLRæ˜¯å¦å­˜åœ¨
        //parentä¸ºæ ¹æ—¶
        //parentä¸Šé¢è¿˜æœ‰ç»“ç‚¹æ—¶
        //æ›´æ–°subLçš„çˆ¶äº²
		Node* subL = parent->_left;
		Node* subLR = subL->_right;
		parent->_left = subLR;
		if (subLR)
		{
			subLR->_parent = parent;
		}
		Node* ppNode = parent->_parent;
		subL->_right = parent;//subLä¸å¯èƒ½ä¸ºç©º æ—‹è½¬æ—¶å¹³è¡¡å› å­è‚¯å®šä¸º2æˆ–-2 å³è¯¥èŠ‚ç‚¹å¾€ä¸‹ä¸€å±‚ä¸€å®šå­˜åœ¨
		parent->_parent = subL;
		if(parent == _root)
		{
			_root = subL;
			subL->_parent = nullptr;
		}
		else
		{
			if (ppNode->_left == parent)
			{
				ppNode->_left = subL;
			}
			else
			{
				ppNode->_right = subL;
			}
			subL->_parent = ppNode;
		}
		
	}
	void RotateL(Node* parent)//å·¦æ—‹
	{
		Node* subR = parent->_right;
		Node* subRL = subR->_left;
		parent->_right = subRL;
		if (subRL)
		{
			subRL->_parent = parent;
		}
		Node* ppNode = parent->_parent;
		subR->_left = parent;
		parent->_parent = subR;
		if (parent == _root)
		{
			_root = subR;
			subR->_parent = nullptr;
		}
		else
		{
			if (ppNode->_left == parent)
			{
				ppNode->_left = subR;
			}
			else
			{
				ppNode->_right = subR;
			}
			subR->_parent = ppNode;
		}
		
	}
    private:
	Node* _root;
};
```

### ğŸŒµåˆ¤æ–­æ˜¯å¦æ˜¯çº¢é»‘æ ‘

æ€è·¯ï¼šæ ¹æ®äº”æ¡æ€§è´¨æ¥åˆ¤æ–­

1. æ¯ä¸ªç»“ç‚¹é¢œè‰²ä¸æ˜¯çº¢è‰²å°±æ˜¯é»‘è‰²

   <font color=green>æšä¸¾ä½“ç¡®å®š</font>

2. æ ¹èŠ‚ç‚¹æ˜¯é»‘è‰²

   <font color=green>æ¡ä»¶åˆ¤æ–­å³å¯</font>

3. å¦‚æœä¸€ä¸ªç»“ç‚¹æ˜¯çº¢è‰²ï¼Œåˆ™å®ƒçš„ä¸¤ä¸ªå­©å­ç»“ç‚¹å¿…ä¸ºé»‘ï¼ˆå³ä¸€æ¡è·¯å¾„ä¸Šä¸ä¼šæœ‰ä¸¤ä¸ªè¿ç»­çš„çº¢ï¼‰

   <font color=green>åˆ¤æ–­æ˜¯å¦æœ‰è¿ç»­çº¢ï¼Œå€ŸåŠ©parentæŒ‡é’ˆç›´æ¥æ‰¾åˆ°çˆ¶äº²</font>

   > çˆ¶äº²ä¸ºçº¢ï¼Œå­©å­å¯èƒ½ä¸å­˜åœ¨ï¼Œä¸å¥½åˆ¤æ–­æ˜¯å¦æœ‰è¿ç»­çº¢ï¼Œä½†æ˜¯æ¯ä¸ªå­©å­éƒ½åªæœ‰ä¸€ä¸ªçˆ¶äº²ï¼Œæ‰€ä»¥å¦‚æœå­©å­ä¸ºçº¢ï¼Œåˆ¤æ–­å…¶çˆ¶äº²æ˜¯å¦ä¸ºçº¢å³å¯åˆ¤æ–­æ˜¯å¦å…·æœ‰è¿ç»­çº¢ç»“ç‚¹ï¼Œæ‰¾çˆ¶äº²å€ŸåŠ©parentæŒ‡é’ˆ

   ```c++
   	bool CheckRED(Node* root)
   	{
   		if (root == nullptr)
   		{
   			return true;
   		}
   		//å­©å­ä¸ä¸€å®šå­˜åœ¨ï¼Œæ‰€ä»¥æ£€æŸ¥çº¢è‰²ç»“ç‚¹çš„çˆ¶äº²æ˜¯å¦ä¸ºçº¢
   		if (root->_col == RED)
   		{
   			if ((root->_parent)->_col == RED)
   			{
   				cout << "è¿ç»­çš„çº¢è‰²ç»“ç‚¹" << endl;
   				return false;
   			} 
   			//è¿™é‡Œä¸èƒ½ç›´æ¥return  true å› ä¸ºè¿˜è¦æ£€æŸ¥è¿™ä¸ªç»“ç‚¹çš„å­æ ‘æ˜¯å¦å­˜åœ¨è¿ç»­çš„çº¢ç»“ç‚¹
   		}
   		return CheckRED(root->_left)
   			&& CheckRED(root->_right);
   
   	}
   ```

   

4. æ¯ä¸ªç»“ç‚¹ï¼Œä»è¯¥èŠ‚ç‚¹åˆ°å¶å­ç»“ç‚¹çš„ç®€å•è·¯å¾„ä¸Šï¼Œå‡åŒ…å«ç›¸åŒæ•°ç›®çš„é»‘è‰²ç»“ç‚¹

   <font color=green>è®°å½•éšä¾¿ä¸€æ¡è·¯å¾„çš„é»‘è‰²ç»“ç‚¹ä½œä¸ºåŸºå‡†å€¼ï¼Œæ¯æ¡è·¯å¾„çš„é»‘è‰²ç»“ç‚¹å’ŒåŸºå‡†å€¼å»åšæ¯”è¾ƒ</font>

   ```c++
   
   	bool CheckBlackNums(Node* root,int blackNums,int benchmark)
   	{
           //blackNumsè¡¨ç¤ºä»æ ¹èŠ‚ç‚¹åˆ°å½“å‰èŠ‚ç‚¹çš„è·¯å¾„æœ‰å‡ ä¸ªé»‘è‰²ç»“ç‚¹
   		if (root == nullptr)
   		{
   			if (blackNums == benchmark)
   			{
   				return true;
   			}
   			else
   			{
   				cout << "æ¯æ¡è·¯å¾„ä¸Šé»‘è‰²èŠ‚ç‚¹ä¸ä¸€æ ·" << endl;
   				return false;
   			}		
   		}
   		if (root->_col == BLACK)
   		{
   			blackNums++;
   		}
   		return CheckBlackNums(root->_left,blackNums,benchmark) && CheckBlackNums(root->_right, blackNums, benchmark);
   
   	}
   ```

   > èµ°åˆ°ç©ºè¡¨ç¤ºæ˜¯ä¸€æ¡è·¯å¾„ï¼Œç„¶åç®—å‡ºçš„é»‘è‰²ç»“ç‚¹çš„ä¸ªæ•°å’ŒåŸºå‡†å€¼å»æ¯”è¾ƒï¼Œç›¸åŒè¿”å›true,å¦åˆ™è¿”å›false

5. æ¯ä¸ªå¶å­ç»“ç‚¹éƒ½æ˜¯é»‘è‰²çš„ï¼ˆæ­¤å¤„çš„å¶å­æ˜¯ç©ºç»“ç‚¹ï¼‰

   <font color=green>ä¸å¿…åˆ¤æ–­</font>

**ä»£ç è°ƒç”¨**

```c++

	bool IsBalance()
	{
		if (_root == nullptr)
		{
			return true;
		}
		if (_root->_col == RED)
		{
			cout << "æ ¹èŠ‚ç‚¹ä¸ºçº¢è‰²" << endl;
			return false;
		}
		int benchmark = 0;
		Node* cur = _root;
		while (cur)
		{
			if (cur->_col == BLACK)
			{
				benchmark++;//ç®—åŸºå‡†å€¼
			}
			cur = cur->_left;
		}
		int blacknum = 0;
		return CheckRED(_root)
			&& CheckBlackNums(_root, blacknum, benchmark);
	}
```

### ğŸŒµæµ‹è¯•ä»£ç 

ç”Ÿæˆä¸€ç³»åˆ—éšæœºå€¼è¿›è¡Œæµ‹è¯•

![image-20220502124049536](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220502124049536.png)

```c++
void test1()//æ’å…¥æµ‹è¯•
{
	RBTree<int,int> rb;
	//rb.Insert(make_pair(4, 1));
	//rb.Insert(make_pair(2, 2));
	//rb.Insert(make_pair(6, 3));
	//rb.Insert(make_pair(1, 4));
	//rb.Insert(make_pair(3, 5));
	//rb.Insert(make_pair(5, 6));
	//rb.Insert(make_pair(15, 7));
	//rb.Insert(make_pair(7, 8));
	//rb.Insert(make_pair(16, 9));
	//rb.Insert(make_pair(14, 10));
	rb.Insert(make_pair(27, 1));
	rb.Insert(make_pair(4, 1));
	rb.Insert(make_pair(12, 1));
	rb.Insert(make_pair(66, 1));
	rb.Insert(make_pair(95, 1));
	rb.Insert(make_pair(82, 1));
	rb.Insert(make_pair(56, 1));
	rb.Insert(make_pair(59, 1));
	rb.Insert(make_pair(73, 1));
	rb.Insert(make_pair(19, 1));

	rb.InOrder();
	cout << rb.IsBalance() << endl;
}
void test2()//æ’å…¥éšæœºç”¨ä¾‹æµ‹è¯•
{
	RBTree<int, int> rb;
	const int n = 1000000;
	vector<int>v;
	v.reserve(n);
	srand(time(0));
	for (int i = 0; i < n; i++)
	{
		v.push_back(rand());
	}
	for (auto e : v)
	{	
		rb.Insert(make_pair(e, e));
	}
	cout << rb.IsBalance() << endl;
}

```



## ğŸŒ´åˆ é™¤

> çº¢é»‘æ ‘çš„åˆ é™¤ä»£ç å†™äº†ä¸¤å¤©ï¼Œæµ‹è¯•ä»£ç æ™šä¸ŠåäºŒç‚¹åŠè¿‡äº†ï¼ˆå¿˜äº†ä¼ æ˜¨å¤©çš„githubğŸ˜­ï¼‰ï¼Œæˆå°±æ„Ÿæ‹‰æ»¡ï¼--è®°å½•äº2022/5/4/00:30
>
> è·Ÿç€è¿™ä¸ªå¤§ä½¬çš„æ€è·¯å®ç°çš„ğŸ‘‰[çº¢é»‘æ ‘-ç»“ç‚¹çš„åˆ é™¤ï¼ˆCè¯­è¨€å®ç°ï¼‰ - Wonkey - åšå®¢å›­ ](https://www.cnblogs.com/wubug/p/13853382.html#:~:text=çº¢é»‘æ ‘çš„åˆ é™¤ç»ˆç©¶æ˜¯å›´ç»•äºŒå‰æŸ¥æ‰¾æ ‘çš„åˆ é™¤ä¸ºåŸºç¡€ï¼Œåœ¨å…¶ä¸Šå¢åŠ äº†é¢œè‰²å’Œçº¢é»‘æ ‘çš„æ€§è´¨ï¼Œé™åˆ¶äº†çº¢é»‘æ ‘åˆ é™¤ç»“ç‚¹åéœ€è¦åšå‡ºç›¸åº”çš„è°ƒæ•´ï¼Œä»¥æ»¡è¶³åˆ é™¤ç»“ç‚¹åä¸æ”¹å˜çº¢é»‘æ ‘ã€‚,çº¢é»‘æ ‘çš„åˆ é™¤ï¼š (1)åˆ é™¤å¶å­ç»“ç‚¹(æ— è®ºå“ªç§æƒ…å†µï¼Œæˆ‘ä»¬æœ€ç»ˆå¤„ç†çš„å°±æ˜¯åˆ é™¤å¶å­ç»“ç‚¹çš„è¿‡ç¨‹ï¼Œ2%2C3æƒ…å†µæœ€åè¿˜æ˜¯è½¬åŒ–ä¸ºåˆ é™¤å¶å­ç»“ç‚¹))

### ğŸŒµé“ºå«

**<font color=RED>æ³¨ï¼šä¸‹é¢æåˆ°çš„é»‘è‰²å¶å­ä¸åŒ…å«NILç»“ç‚¹</font>**

ç±»æ¯”äºŒå‰æœç´¢æ ‘çš„åˆ é™¤ï¼Œåˆ é™¤åˆ†ä¸ºåˆ é™¤å¶å­ï¼Œåˆ é™¤åªæœ‰ä¸€ä¸ªå­©å­çš„ç»“ç‚¹ï¼Œåˆ é™¤æœ‰å·¦å³å­©å­çš„ç»“ç‚¹ã€‚

ä¸ºç©º(ä¸å­˜åœ¨)çš„ç»“ç‚¹ç»Ÿä¸€çœ‹åšé»‘è‰²ç»“ç‚¹ï¼Œä»£ç å®ç°ä¸Šå¦‚æœè¦ç”¨åˆ°NILç»“ç‚¹å°±newä¸€ä¸ªé»‘è‰²çš„ä¸´æ—¶ç»“ç‚¹ã€‚

**<font size=5><font color= #48D1CC>ä¸‹é¢å›¾ä¸­çš„é»‘è‰²ç»“ç‚¹ä¸åŒ…æ‹¬NILç»“ç‚¹</font></font>**

![image-20220505002515136](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505002515136.png)

[æµç¨‹å›¾é«˜æ¸…å›¾ç‰‡](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505150508476.png)

```mermaid
graph LR
A(åˆ é™¤å¶å­)-->B(åˆ é™¤çº¢è‰²å¶å­)
B--ç›´æ¥åˆ -->D(åˆ é™¤ç»“æŸ)
A-->C(åˆ é™¤é»‘è‰²å¶å­)
C--æƒ…å†µå¾ˆå¤æ‚,åé¢å±•å¼€-->D

E(åˆ é™¤å•æ”¯)-->F(åˆ é™¤é»‘çº¢å•æ”¯)-->G(æŠŠçº¢è‰²å¶å­æ¶‚é»‘, æŠŠæ¶‚é»‘çš„çº¢è‰²å¶å­ä¸é»‘è‰²ç»“ç‚¹çš„çˆ¶äº²è¿æ¥,å†åˆ é™¤é»‘è‰²ç»“ç‚¹)
G-->D
E-->J(é»‘é»‘å•æ”¯)
J-->K(é»‘é»‘å•æ”¯ä¸ä¼šå‡ºç°)
E-->L(çº¢é»‘å•æ”¯)
L-->M(çº¢é»‘å•æ”¯ä¸ä¼šå‡ºç°)
H(åˆ é™¤åŒæ”¯)--æ‰¾åˆ°æ›¿ä»£ç»“ç‚¹-->I(è½¬åŒ–ä¸ºåˆ é™¤å¶å­æˆ–å•æ”¯)
```

> - çœ‹åˆ°ä¸Šé¢çš„å›¾ä¼šå‘ç°ï¼Œåªè¦æå®šäº†åˆ é™¤é»‘è‰²å¶å­å°±å¤§åŠŸå‘Šæˆäº†ã€‚è¿™ä¹Ÿç¡®ç¡®å®å®æ˜¯æœ€éº»çƒ¦çš„ä¸€æ­¥ï¼Œ**åˆ é™¤é»‘è‰²å¶å­**ç›´æ¥å¯¼è‡´è¿™æ¡è·¯å¾„é»‘è‰²ç»“ç‚¹æ•°å‡1ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æƒ³æ–¹è®¾æ³•**<font color =#40E0D0>åœ¨è¿™æ¡è·¯å¾„ä¸ŠåŠ ä¸Šä¸€ä¸ªé»‘è‰²ç»“ç‚¹ï¼Œæˆ–è€…ç›´æ¥æŠŠæ‰€æœ‰è·¯å¾„éƒ½å‡å°‘ä¸€ä¸ªé»‘è‰²ç»“ç‚¹ï¼Œå†å¾€ä¸Šé€’å½’å¤„ç†</font>**
>
> > å‡å°‘ä¸€ä¸ªé»‘è‰²ç»“ç‚¹ä¸ºä»€ä¹ˆéœ€è¦å¾€ä¸Šé€’å½’ï¼Ÿæˆ‘ä»¬å¯¹çº¢é»‘æ ‘æ“ä½œçš„åŸå› ï¼šè¿™æ¡è·¯å¾„å°‘äº†ä¸€ä¸ªé»‘è‰²ç»“ç‚¹ã€‚å½“æˆ‘ä»¬æ“ä½œè¿™æ£µå­æ ‘åä½¿å¾—ç»è¿‡è¿™æ£µå­æ ‘çš„æ‰€æœ‰è·¯å¾„çš„é»‘è‰²ç»“ç‚¹æ•°éƒ½å‡1ï¼Œä¸ºäº†ä½¿å¾—**æ•´æ£µæ ‘å¹³è¡¡**ï¼Œè‡ªç„¶å°±ä»¥è¿™æ£µå­æ ‘çš„æ ¹è¿›è¡Œé€’å½’ï¼Œ**é€’å½’å‡ºå£**ï¼šé€’å½’åˆ°æ ¹ï¼ˆè®©æ•´æ£µæ ‘æ‰€æœ‰è·¯å¾„é»‘è‰²ç»“ç‚¹å‡1ï¼‰æˆ–è€…åœ¨è¿™äº›è·¯å¾„å‰åŠ ä¸Šä¸€ä¸ªé»‘è‰²ç»“ç‚¹ä½¿å¾—æ•´æ£µæ ‘å¹³è¡¡ï¼ˆä¹Ÿå°±æ˜¯ç¬¬ä¸€ç§æƒ…å†µï¼‰,ä»¥ä¸‹å›¾ä¸ºä¾‹
>
> - **<font color=green>åˆ é™¤é»‘è‰²å¶å­éœ€è¦æ ¹æ®å…¶<font color=#40E0D0>å…„å¼Ÿå’Œä¾„å­çš„æƒ…å†µ</font>æ¥è¿›è¡Œç›¸å¯¹åº”çš„åˆ¤æ–­</font>**
>
> - é»‘çº¢å•æ”¯åˆ çš„å°±æ˜¯é»‘è‰²ç»“ç‚¹ï¼Œé»‘çº¢å•æ”¯è¡¨ç¤ºçš„æ˜¯åªæœ‰ä¸€ä¸ªå­©å­ä¸”å­©å­ä¸ºçº¢çš„æƒ…å†µ
>
> - ä¸Šé¢è¯´çš„é»‘é»‘å•æ”¯æ˜¯ä¸å¯èƒ½å‡ºç°ï¼Œä½†æ˜¯å½“é»‘è‰²ç»“ç‚¹åŒ…æ‹¬NILç»“ç‚¹æ—¶ï¼Œå°±å¯èƒ½ä¼šå‡ºç°äº†
>
> ![image-20220505151018136](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505151018136.png)
>
> 
>
> - åˆ é™¤åŒæ”¯æˆ‘ä¸€èˆ¬æ‰¾åç»§ï¼ˆå³å­æ ‘æœ€å°çš„å€¼/å³å­æ ‘æœ€å·¦è¾¹çš„å¶å­ï¼‰ä½œä¸ºæ›¿ä»£ç»“ç‚¹ï¼Œæˆ‘åé¢å›¾ä¸­ç”»çš„æ‰€æœ‰é»‘è‰²ç»“ç‚¹éƒ½æ˜¯åç»§èŠ‚ç‚¹ï¼Œæ‰€ä»¥é»˜è®¤é»‘è‰²ç»“ç‚¹çš„å·¦å­æ ‘ä¸ºç©ºï¼Œè€Œå³å­æ ‘ä¸ä¸€å®šä¸ºç©ºï¼Œå½“å³å­æ ‘ä¸ä¸ºç©ºæ—¶ï¼Œåˆ é™¤åŒæ”¯å°±è½¬åŒ–æˆäº†åˆ é™¤é»‘çº¢å•æ”¯ï¼Œè‹¥å³å­æ ‘ä¸ºç©ºï¼Œåˆ™è½¬ä¸ºäº†åˆ é™¤é»‘è‰²å¶å­
> - è®°ä¸€ä¸‹ä¸‹é¢é‚£å¼ å›¾é‡Œç»“ç‚¹çš„åç§°ï¼Œ~~è¿™æ ·åé¢æ‰çŸ¥é“æˆ‘åœ¨è¯´å•¥~~
>
> ![image-20220505152847275](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505152847275.png)
>
> ~~æˆ‘æŠŠå¾…åˆ é™¤çš„é»‘è‰²å¶å­ç”»åœ¨å·¦å­æ ‘ï¼Œç”»åœ¨å³å­æ ‘ä¹ŸåŒç†~~
>
> - ç™½è‰²ç»“ç‚¹è¡¨ç¤ºé¢œè‰²éšæ„ï¼Œå³é»‘è‰²å’Œçº¢è‰²éƒ½å¯å–
>
> ![image-20220505160845568](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505160845568.png)
>
> 

### ğŸŒµåˆ é™¤çš„å„ç§æƒ…å†µ

1. <font color=green>**å¶å­**</font>

1.1 <font color=blue>çº¢è‰²å¶å­</font>

<font color= #48D1CC>**ç›´æ¥åˆ **</font>ï¼Œä¸æ”¹å˜é»‘é«˜ï¼ˆä»xç»“ç‚¹å‡ºå‘åˆ°å¶å­çš„è¿™æ¡è·¯å¾„ä¸Šé»‘è‰²ç»“ç‚¹çš„æ•°ç›®å°±æ˜¯é»‘é«˜ï¼Œè®°ä¸ºbh(x)ï¼‰

> bh==black height

1.2 <font color=blue>é»‘è‰²å¶å­</font>

åé¢è®¨è®ºï¼Œæƒ…å†µè¾ƒå¤š

2. **<font color=green>å•æ”¯</font>**

2.1 <font color=blue>çº¢é»‘å•æ”¯å’Œçº¢çº¢å•æ”¯</font>

<font color= #48D1CC>**ä¸åˆç†**</font>ï¼Œä¸ä¼šå‡ºç°éœ€è¦å¤„ç†çš„æƒ…å†µ

2.2 <font color=blue>é»‘çº¢å•æ”¯</font>

**<font color= #48D1CC>æŠŠçº¢è‰²ç»“ç‚¹æ¶‚é»‘ï¼ŒæŠŠçº¢è‰²ç»“ç‚¹ä¸é»‘è‰²ç»“ç‚¹çš„çˆ¶äº²ç›¸è¿æ¥ï¼Œå†åˆ é™¤é»‘è‰²ç»“ç‚¹</font>**

> - ä¸Šé¢æ“ä½œçš„é¡ºåºæ˜¯ä»£ç å®ç°æ—¶çš„é¡ºåºï¼Œç”»å›¾æ—¶ç¨ç¨æœ‰ç‚¹ä¸åŒ
> - å½“åˆ é™¤çš„é»‘è‰²ç»“ç‚¹ä¸ºæ ¹æ—¶ä»£ç ä¸­å•ç‹¬å¤„ç†

![image-20220505161646319](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505161646319.png)

ç›¸ä¼¼çš„ç¬¬äºŒç§æƒ…å†µ

![image-20220505161901529](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505161901529.png)

> è¿™æ˜¯å¾…åˆ é™¤ç»“ç‚¹åœ¨å·¦å­æ ‘ä¸”ä¸ºé»‘çº¢å•æ”¯çš„æƒ…å†µï¼Œå¯ä»¥è‡ªå·±ç”»ä¸€ä¸‹å¾…åˆ é™¤ç»“ç‚¹åœ¨å³å­æ ‘çš„æƒ…å†µ

3. åŒæ”¯

è½¬ä¸ºå•æ”¯æˆ–è€…å¶å­å¤„ç†

#### ğŸƒåˆ é™¤é»‘è‰²å¶å­

åˆ é™¤é»‘è‰²å¶å­çš„æœ¬è´¨å°±æ˜¯è°ƒæ•´é»‘é«˜ï¼Œè®©åˆ é™¤äº†é»‘è‰²å¶å­çš„é‚£æ¡è·¯å¾„ä¸Šå¤šå‡ºä¸€ä¸ªé»‘è‰²ç»“ç‚¹è¾¾åˆ°å¹³è¡¡ï¼Œæˆ–è€…è®©æ¯æ¡è·¯å¾„ä¸Šçš„é»‘è‰²ç»“ç‚¹æ•°éƒ½

å‡1ã€‚

ä¸‹é¢å…³ç³»çš„åŸºå‡†éƒ½æ˜¯é»‘è‰²å¶å­ï¼Œæ¯”å¦‚çˆ¶äº²æŒ‡çš„å°±æ˜¯é»‘è‰²å¶å­çš„çˆ¶äº²

[æµç¨‹å›¾å›¾ç‰‡](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505165003028.png)

```mermaid
graph LR
A(åˆ é™¤é»‘è‰²å¶å­)-->B(é»‘è‰²å¶å­ä¸ºæ ¹)
A-->C(å…„å¼Ÿç»“ç‚¹ä¸ºé»‘)
A-->D(å…„å¼Ÿç»“ç‚¹ä¸ºçº¢)
B-->E(ç›´æ¥åˆ )
E-->F(åˆ é™¤æˆåŠŸ)
C-->G(ä¾„å­å…¨é»‘)
C-->H(ä¾„å­ä¸å…¨é»‘)
D--æ—‹è½¬-->C
G-->I(çˆ¶äº²ä¸ºçº¢)
G-->J(çˆ¶äº²ä¸ºé»‘)
I--çˆ¶äº²æ¶‚é»‘, å…„å¼Ÿæ¶‚çº¢-->F
J--çˆ¶äº²ä¸ºæ ¹ å…„å¼Ÿæ¶‚çº¢ -->F
J--çˆ¶äº²ä¸ä¸ºæ ¹ å…„å¼Ÿæ¶‚çº¢ çˆ¶äº²ä½œä¸ºæ–°çš„ç ”ç©¶å¯¹è±¡å‘ä¸Šé€’å½’-->A
H-->K(çˆ¶äº²,å…„å¼Ÿ,çº¢è‰²ä¾„å­åœ¨ä¸€æ¡ç›´çº¿ä¸Š)-->M(å•æ—‹+å˜è‰²)-->F
H-->L(çˆ¶äº²,å…„å¼Ÿ,çº¢è‰²ä¾„å­ä¸åœ¨ä¸€æ¡ç›´çº¿ä¸Š)-->N(åŒæ—‹+å˜è‰²)-->F

```

1. **<font color= #48D1CC>é»‘è‰²å¶å­ä¸ºæ ¹</font>**

å¶å­è¯´æ˜å·¦å³å­æ ‘ä¸ºç©ºï¼Œåˆæ˜¯æ ¹ï¼Œåˆ å®Œç›´æ¥å˜æˆç©ºæ ‘ã€‚

![image-20220505165151218](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505165151218.png)

2. **<font color= #48D1CC>å…„å¼Ÿï¼Œä¾„å­å…¨é»‘</font>**

2.1 <font color=blue>çˆ¶äº²ä¸ºçº¢</font>

çˆ¶äº²æ¶‚é»‘ï¼Œå…„å¼Ÿæ¶‚çº¢å³å¯

![image-20220505192858018](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505192858018.png)

2.2 <font color=blue>çˆ¶äº²ä¸ºé»‘</font>

å˜è‰²+é€’å½’

> é€’å½’å‡ºå£:é€’å½’çš„å¯¹è±¡å˜åˆ°äº†æ ¹ç»“ç‚¹ï¼ˆä¸€ç›´å‘ä¸Šé€’å½’åˆ°äº†æ ¹èŠ‚ç‚¹ï¼‰æˆ–è€…è½¬ä¸ºåˆ«çš„å¯ä»¥ç›´æ¥ç»“æŸçš„æƒ…å†µï¼Œæ¯”å¦‚æƒ…å†µ3ã€‚

![image-20220505193322565](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505193322565.png)

3. **<font color= #48D1CC>å…„å¼Ÿä¸ºé»‘ï¼Œä¾„å­ä¸å…¨é»‘</font>**

ä¾„å­ä¸å…¨é»‘ï¼Œè¡¨ç¤ºçš„æƒ…å†µæœ‰å·¦å³ä¾„å­éƒ½ä¸ºçº¢ï¼Œå·¦å³ä¾„å­ä¸€çº¢ä¸€é»‘

> ä¾„å­ä¸å…¨é»‘==è‡³å°‘æœ‰ä¸€çº¢

3.1 <font color=blue>çˆ¶äº²ã€å…„å¼Ÿã€çº¢è‰²ä¾„å­åœ¨ä¸€æ¡ç›´çº¿ä¸Š</font>

å•æ—‹+å˜è‰²

Nåœ¨å·¦å­æ ‘

![image-20220505195359761](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505195359761.png)

Nåœ¨å³å­æ ‘

![image-20220505200022874](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505200022874.png)

3.2 <font color=blue>çˆ¶äº²ã€å…„å¼Ÿã€çº¢è‰²ä¾„å­åœ¨ä¸€æ¡æŠ˜çº¿ä¸Š</font>

Nåœ¨å·¦å­æ ‘

![](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505201817217.png)

4. **<font color= #48D1CC>å…„å¼Ÿä¸ºçº¢</font>**

**å…„å¼Ÿä¸ºçº¢å¯çŸ¥çˆ¶å­å’Œä¾„å­å¿…ä¸ºé»‘**

4.1 Nåœ¨å³å­æ ‘

![image-20220505193647549](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505193647549.png)

4.2 Nåœ¨å·¦å­æ ‘

![image-20220505193832995](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505193832995.png)

> å¾€ä¸Šç¿»ä¸€ä¸‹ï¼Œå¯ä»¥å‘ç°æƒ…å†µ2.2çš„æœ€åä¸€ä¸ªå›¾å’Œæƒ…å†µ4.2çš„ç¬¬ä¸€ä¸ªå›¾æ˜¯ä¸€æ ·çš„
>
> æƒ…å†µ2.2çš„æœ€åä¸€ä¸ªå›¾
>
> ![image-20220505194144913](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505194144913.png)
>
> æƒ…å†µ4.2çš„ç¬¬ä¸€ä¸ªå›¾
>
> ![image-20220505194229344](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505194229344.png)
>
> é‚£æ˜¯ä¸æ˜¯è¯´æ˜å¯¹æƒ…å†µ2.2æœ€åä¸€ä¸ªå›¾çš„å¤„ç†å¯ä»¥è½¬æˆå¯¹æƒ…å†µ4.2çš„å¤„ç†å‘¢ï¼Ÿ
>
> ä¸è¡Œï¼Œä¸¤ä¸ªå›¾ä¸€æ ·ï¼Œä½†æ˜¯æƒ…å†µ2.2æœ€åä¸€ä¸ªå›¾çš„ç ”ç©¶å¯¹è±¡å·²ç»æ”¹æˆparentäº†ï¼ŒæŠŠparentå½“æˆæ–°çš„Nå»å’Œæƒ…å†µ4.2å»æ¯”è¾ƒæ˜¾ç„¶ä¸ä¸€å®šç›¸åŒ

#### ğŸƒè‰ç¨¿

> è‰ç¨¿ä¸­çš„SLå’ŒSRè¡¨ç¤ºå·¦å³ä¾„å­
>
> Nè¡¨ç¤ºNILç»“ç‚¹ï¼Œå› ä¸ºæ˜¯é»‘è‰²å¶å­ï¼Œå­æ ‘éƒ½ä¸ºç©ºï¼Œæ‰€ä»¥æ›¿ä»£é»‘è‰²å¶å­çš„å°±æ˜¯NILç»“ç‚¹ï¼ˆNILç»“ç‚¹é»˜è®¤ä¸ºé»‘ï¼Œè¿™æ˜¯æ€§è´¨äº”ï¼‰

![image-20220505162522069](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505162522069.png)

![image-20220505162639467](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505162639467.png)

![image-20220505162958229](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505162958229.png)

### ğŸŒµä»£ç å®ç°

- ä»£ç åˆ é™¤é»‘è‰²å¶å­çš„å®ç°é‡Œæˆ‘å¹¶æ²¡æœ‰ç›´æ¥åˆ æ‰å¾…åˆ é™¤çš„ç»“ç‚¹ï¼Œè€Œæ˜¯è®°å½•ä¸‹è¦åˆ é™¤çš„ç»“ç‚¹æœ€åå†åˆ ï¼Œå¦‚æœç›´æ¥åˆ é™¤åå†ç”¨ç©ºèŠ‚ç‚¹å»æ›¿ä»£å¯¼è‡´åé¢ä¸å¥½æ“ä½œï¼Œæ‰€ä»¥ä»£ç é‡Œæ“ä½œçš„å…¶å®æ˜¯æŠŠå¾…åˆ é™¤çš„ç»“ç‚¹å½“åšä¸Šé¢é‚£äº›å›¾ä¸­çš„Nç»“ç‚¹
- ä¸å­˜åœ¨çš„ç»“ç‚¹(ä¸ºç©ºçš„ç»“ç‚¹çš„)å¯èƒ½å¯¼è‡´ç©ºæŒ‡é’ˆå¼•ç”¨çš„é—®é¢˜ï¼Œæ‰€ä»¥å¯èƒ½ä¸ºç©ºçš„æƒ…å†µå…¨éƒ¨è®¾ç½®äº†ä¸€ä¸ªä¸´æ—¶ç»“ç‚¹
- ä»£ç çš„æ€è·¯æ˜¯å…ˆå¤„ç†å•æ”¯å’Œçº¢è‰²å¶å­ï¼Œå†æŠŠåŒæ”¯å¤„ç†æˆå•æ”¯æˆ–å¶å­å¤„ç†ï¼Œå¦‚æœéœ€è¦åˆ é™¤é»‘è‰²å¶å­é‚£å°±è¿›è¡Œåˆ é™¤é»‘è‰²å¶å­çš„æ“ä½œ
- ä»£ç é‡Œä¸€äº›ç»†èŠ‚éœ€è¦æ³¨æ„ï¼Œæ¯”å¦‚é»‘çº¢å•æ”¯çš„é»‘è‰²ç»“ç‚¹ä¸ºæ ¹æ—¶
- ä»£ç å¯èƒ½æœ‰äº›å†—é•¿~~éƒ½æ˜¯è‡ªå·±å†™çš„ï¼Œçº¢é»‘æ ‘çš„åˆ é™¤è¿™å—æ²¡æ‰¾åˆ°æ¨¡æ¿å¼æ ‡å‡†çš„ä»£ç ~~

```c++
	bool Erase(const pair<K,V>&kv)
	{
		Node* cur = _root;
		while (cur)
		{
			if ( (cur->_kv).first>kv.first )
			{
				cur = cur->_left;
			}
			else if ((cur->_kv).first < kv.first)
			{
				cur = cur->_right;
			}
			else//æ‰¾åˆ°äº†
			{
				break;
			}
		}
		if (cur==nullptr)
		{
			return false;
		}
		if (cur == _root&&cur->_right==nullptr&&cur->_left!=nullptr)//ç›´æ¥åˆ é™¤æ ¹ ä¸”å³å­æ ‘ä¸ºç©º
		{
			_root = cur->_left;
			_root->_col = BLACK;
            _root->_parent = nullptr;
			delete cur;
			cur = nullptr;
			return true;
		}
		if (cur == _root && cur->_right != nullptr && cur->_left == nullptr)//ç›´æ¥åˆ é™¤æ ¹ ä¸”å³å­æ ‘ä¸ºç©º
		{
			_root = cur->_right;
			_root->_col = BLACK;
            _root->_parent = nullptr;
			delete cur;
			cur = nullptr;
			return true;
		}

		Node* realDel = nullptr;
		Node* parent = cur->_parent;

		if (cur->_right == nullptr && cur->_left == nullptr)//å¶å­
		{
			if (cur->_col == RED)//çº¢è‰²å¶å­ç›´æ¥åˆ 
			{
				if (parent->_left == cur)
				{
					parent->_left = nullptr;
				}
				else
				{
					parent->_right = nullptr;
				}
				delete cur;
				cur = nullptr;
			}
			else//é»‘è‰²å¶å­
			{
				realDel = cur;//è®°å½•ä¸‹æ¥å¾…å¤„ç†
			}
		}
		else if (cur->_right == nullptr&&cur->_left!=nullptr)//åªæœ‰å·¦å­æ ‘
		{
			if (cur->_col == BLACK)//ä¸Šé»‘ä¸‹çº¢çš„é»‘è‰²å•æ”¯
			{
				
				if (parent->_left == cur)
				{
					parent->_left = cur->_left;
					cur->_left->_parent = parent;
				}
				else
				{
					parent->_right = cur->_left;
					cur->_left->_parent = parent;

				}
				cur->_left->_col = BLACK;
				delete cur;
				cur = nullptr;
			}
			else//æˆ‘è®¤ä¸ºè¿™ç§æƒ…å†µä¸ä¼šæœ‰ å¦‚æœæœ‰å°±æ‰“å°
			{
				cout << "å‡ºç°äº†åªæœ‰å·¦å­æ ‘çš„å•æ”¯ï¼Œä½†ä¸Šé¢çš„é¢œè‰²ä¸æ˜¯é»‘è‰²" << endl;
			}
		
		}
		else if (cur->_left == nullptr&&cur->_right!=nullptr)//åªæœ‰å³å­æ ‘
		{
			if (cur->_col == BLACK)
			{
				if (parent->_left == cur)
				{
					parent->_left = cur->_right;
					cur->_right->_parent = parent;
				}
				else
				{
					parent->_right = cur->_right;
					cur->_right->_parent = parent;
				}
				cur->_right->_col = BLACK;
				
				delete cur;
				cur = nullptr;
			}
			else//æˆ‘è®¤ä¸ºè¿™ç§æƒ…å†µä¸ä¼šæœ‰
			{
				cout << "å‡ºç°äº†åªæœ‰å³å­æ ‘çš„å•æ”¯ï¼Œä½†ä¸Šé¢çš„é¢œè‰²ä¸æ˜¯é»‘è‰²" << endl;
			}
		}
		else//æœ‰å·¦å³å­æ ‘
		{
			Node* minRight = cur->_right;
			Node* minRightParent=cur ;
			while (minRight->_left)
			{
				minRightParent = minRight;
				minRight = minRight->_left;
			}
		
			cur->_kv = minRight->_kv;
			if (minRight->_col == RED&&minRight->_right==nullptr)//æ²¡æœ‰å³å­æ ‘ï¼Œæ›¿æ¢çš„è¿™ä¸ªæ˜¯çº¢è‰²å¶å­
			{
				if (minRightParent->_left == minRight)
				{
					minRightParent->_left = nullptr;
				}
				else
				{
					minRightParent->_right = nullptr;
				}
				delete minRight;
				minRight = nullptr;
			}
			else if (minRight->_col == BLACK && minRight->_right != nullptr)//å­˜åœ¨å³å­æ ‘ä¸”ä¸æ˜¯å¶å­
			{
				if (minRightParent->_left == minRight)
				{
					minRightParent->_left = minRight->_right;
					minRight->_right->_parent = minRightParent;
				}
				else
				{
					minRightParent->_right = minRight->_right;
					minRight->_right->_parent = minRightParent;
				}
				minRight->_right->_col = BLACK;
				delete minRight;
				minRight = nullptr;
			}
			else if(minRight->_col==BLACK&&minRight->_right==nullptr)//é»‘è‰²å¶å­
			{
				realDel = minRight;//è®°å½•ä¸‹æ¥å¾…å¤„ç†
			}
			else//æˆ‘è®¤ä¸ºè¿™ç§æƒ…å†µä¸ä¼šæœ‰
			{
				cout << "å­˜åœ¨äº†ä¸ç¬¦åˆè¦æ±‚çš„æƒ…å†µ" << endl;
			}
		}
		if (realDel == nullptr)
		{
			return true;
		}
		//åˆ é™¤é»‘è‰²å¶å­
		/*
			1.é»‘è‰²å¶å­ä¸ºæ ¹æ—¶ 
			2.å…„å¼Ÿä¾„å­å…¨é»‘  --> çœ‹çˆ¶äº²
			3.å…„å¼Ÿä¸ºé»‘ ä¾„å­ä¸å…¨é»‘-->çœ‹ç›´çº¿/æŠ˜çº¿
			4.å…„å¼Ÿä¸ºçº¢ æ—‹è½¬æˆæƒ…å†µ2
		*/
		if (realDel == _root)
		{
			cout << "å·²åˆ é™¤æ ¹" << endl;
			_root = nullptr;
			return true;
		}
		//ä¸æ˜¯æ ¹èŠ‚ç‚¹ é»‘è‰²å¶å­è‚¯å®šæœ‰çˆ¶äº²
		Node* del = realDel;//è®°å½•å¾…åˆ é™¤çš„ç»“ç‚¹  
		while (realDel != _root && realDel->_col==BLACK)
		{
			Node* DelParent = realDel->_parent;
			Node* sibling;
			if (DelParent->_left == realDel)
			{
				sibling = DelParent->_right;
			}
			else
			{
				sibling = DelParent->_left;
			}
			if (sibling == nullptr)
			{
				sibling= new Node(make_pair(-999, 0));
				sibling->_col = BLACK;
			}
			Node* nephew_left = sibling->_left;
			Node* nephew_right = sibling->_right;
			if (nephew_left == nullptr)
			{
				nephew_left = new Node(make_pair(-999,0));
				nephew_left->_col = BLACK;
			}
			if (nephew_right == nullptr)
			{
				nephew_right= new Node(make_pair(-999,0));
				nephew_right->_col = BLACK;
			}
			if (sibling->_col == BLACK && nephew_right->_col == BLACK && nephew_left->_col == BLACK)
			{
				//å…„å¼Ÿä¾„å­å…¨é»‘
				if (DelParent->_col == RED)
				{
					//çˆ¶äº²ä¸ºçº¢
					DelParent->_col = BLACK;
					sibling->_col = RED;
					break;
				}
				else
				{
					//çˆ¶äº²ä¸ºé»‘
					sibling->_col = RED;
					realDel = realDel->_parent;
				}

			}
			else if (sibling->_col == BLACK && (!(nephew_right->_col == BLACK && nephew_left->_col == BLACK)))
			{
				//å…„å¼Ÿä¸ºé»‘ ä¾„å­ä¸å…¨é»‘

				if (DelParent->_right == sibling && nephew_right->_col == RED)
				{
					//ç›´çº¿
					sibling->_col = DelParent->_col;
					DelParent->_col = BLACK;
					RotateL(DelParent);
					nephew_right->_col = BLACK;
					
				}
				else if (DelParent->_left == sibling && nephew_left->_col == RED)
				{
					//ç›´çº¿
					sibling->_col = DelParent->_col;
					DelParent->_col = BLACK;
					RotateR(DelParent);
					nephew_left->_col = BLACK;
				}
				else if (DelParent->_left==sibling&&nephew_right->_col==RED)
				{
					//æŠ˜çº¿
					RotateL(sibling);
					nephew_right->_col = BLACK;
					sibling->_col = RED;
					nephew_left = sibling;
					sibling = nephew_right;
					RotateR(DelParent);
					sibling->_col = DelParent->_col;
					DelParent->_col = BLACK;
					nephew_left->_col = BLACK;
				}
				else if (DelParent->_right==sibling&&nephew_left->_col==RED)
				{
					//æŠ˜çº¿
					RotateR(sibling);
					nephew_left->_col = BLACK;
					sibling->_col = RED;
					nephew_right = sibling;
					sibling = nephew_left;
					RotateL(DelParent);
					sibling->_col = DelParent->_col;
					DelParent->_col = BLACK;
					nephew_right->_col = BLACK;
				}
				else
				{
					assert(false);
				}
				break;
			}
			else if (sibling->_col == RED)
			{
				//å…„å¼Ÿä¸ºçº¢
				if (DelParent->_left == sibling && sibling->_col == RED)
				{
					RotateR(DelParent);
					sibling->_col = BLACK;
					DelParent->_col = RED;
				}
				else if (DelParent->_right == sibling && sibling->_col == RED)
				{
					RotateL(DelParent);
					sibling->_col = BLACK;
					DelParent->_col = RED;
				}
			}
			else
			{
				assert(false);
			}
		}
		Node* delParent = del->_parent;
		
		if (delParent->_left == del)//åˆ°è¿™é‡Œçš„éƒ½æ˜¯å¶å­
		{
			delParent->_left = del->_right;
		
			/*if (del->_right)//è¿™é‡Œæµ‹è¯•è¯´æ˜åˆ é™¤çš„å¿…å®šæ˜¯å¶å­
			{
				cout << "del->_rightéç©º" << endl;
				del->_right->_parent = delParent;
			}*/
			delete del;
			del = nullptr;
		}
		else
		{
			delParent->_right = del->_right;
		
		/*	if (del->_right)//è¿™é‡Œæµ‹è¯•è¯´æ˜åˆ é™¤çš„å¿…å®šæ˜¯å¶å­
			{
				cout << "del->_rightéç©º" << endl;
				del->_right->_parent = delParent;
			}*/

			delete del;
			del = nullptr;
		}
		return true;
	}
```

### ğŸŒµæµ‹è¯•ä»£ç 

test4()æ˜¯éšæœºç”Ÿæˆäº†åä¸‡ç»„æ•°æ®æµ‹è¯•ï¼Œæµ‹è¯•é€šè¿‡

åé¢çš„test5(),test6()éƒ½æ˜¯æˆ‘å†™ä»£ç è¿‡ç¨‹ä¸­å¿½ç•¥çš„ç»†èŠ‚ï¼Œæ¯”å¦‚å•æ”¯ç»“ç‚¹ä¸ºæ ¹æ—¶ï¼Œä¸‰å‰é“¾å¿˜äº†æ›´æ–°çˆ¶äº²ç­‰ï¼Œå¦‚æœè‡ªå·±å°è¯•å®ç°äº†ï¼Œå¯ä»¥å¥—ç”¨ä¸‹é¢å‡ ä¸ªæµ‹è¯•ç”¨ä¾‹è¿›è¡Œæµ‹è¯•

```c++

void test3()//åŸºæœ¬åˆ é™¤æµ‹è¯•
{
	RBTree<int, int> rb;
	rb.Insert(make_pair(27, 1));
	rb.Insert(make_pair(4, 1));
	rb.Insert(make_pair(12, 1));
	rb.Insert(make_pair(66, 1));
	rb.Insert(make_pair(95, 1));
	rb.Insert(make_pair(82, 1));
	rb.Insert(make_pair(56, 1));
	rb.Insert(make_pair(59, 1));
	rb.Insert(make_pair(73, 1));
	rb.Insert(make_pair(19, 1));
	
	rb.Erase(make_pair(19, 1));
	rb.Erase(make_pair(27, 1));
	rb.Erase(make_pair(4, 1));
	rb.Erase(make_pair(59, 1));
	rb.Erase(make_pair(82, 1));

	cout << rb.IsBalance() << endl;

}



void test4()//éšæœºåˆ é™¤æµ‹è¯•
{
	RBTree<int, int> rb;
	const int n =100000;
	vector<int>v;
	v.reserve(n);
	srand(time(0));
	for (int i = 0; i < n; i++)
	{
		v.push_back(rand());
	}
	for (auto e : v)
	{
		//cout << e << " " << endl;
		rb.Insert(make_pair(e, e));
	}
	for (auto e : v)
	{
		
		rb.Erase(make_pair(e, e));
		if (rb.IsBalance() == 0)
		{
			cout << "å­˜åœ¨åˆ é™¤ä¸æˆåŠŸ" << endl;
		}
	}
	cout << "åˆ é™¤æˆåŠŸ" << endl;
	
}

void test5()//éšæœºç”¨ä¾‹æµ‹è¯•
{
	RBTree<int, int> rb;
	rb.Insert(make_pair(24, 1));
	rb.Insert(make_pair(70, 1));
	rb.Insert(make_pair(42, 1));
	rb.Insert(make_pair(50, 1));
	rb.Insert(make_pair(89, 1));
	rb.Insert(make_pair(52, 1));
	rb.Insert(make_pair(48, 1));
	rb.Insert(make_pair(5, 1));
	rb.Insert(make_pair(24, 1));
	rb.Insert(make_pair(3, 1));

	rb.Erase(make_pair(24, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(70, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(42, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(50, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(89, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(52, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(48, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(5, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(24, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(3, 1));
	cout << rb.IsBalance() << endl;
}

void test6()//éšæœºç”¨ä¾‹æµ‹è¯•
{
	RBTree<int, int> rb;
	rb.Insert(make_pair(12, 1));
	rb.Insert(make_pair(88, 1));
	rb.Insert(make_pair(11, 1));
	rb.Insert(make_pair(29, 1));
	rb.Insert(make_pair(41, 1));
	rb.Insert(make_pair(73, 1));
	rb.Insert(make_pair(96, 1));
	rb.Insert(make_pair(49, 1));
	rb.Insert(make_pair(26, 1));
	rb.Insert(make_pair(18, 1));

	rb.Erase(make_pair(12, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(88, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(11, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(29, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(41, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(73, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(96, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(49, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(26, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(18, 1));
	cout << rb.IsBalance() << endl;
}


void test7()//éšæœºç”¨ä¾‹æµ‹è¯•
{
	RBTree<int, int> rb;
	rb.Insert(make_pair(34, 1));
	rb.Insert(make_pair(81, 1));
	rb.Insert(make_pair(91, 1));
	rb.Insert(make_pair(52, 1));
	rb.Insert(make_pair(78, 1));
	rb.Insert(make_pair(20, 1));
	rb.Insert(make_pair(61, 1));
	rb.Insert(make_pair(1, 1));
	rb.Insert(make_pair(10, 1));
	rb.Insert(make_pair(12, 1));

	rb.Erase(make_pair(34, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(81, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(91, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(52, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(78, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(20, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(61, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(1, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(10, 1));
	cout << rb.IsBalance() << endl;
	rb.Erase(make_pair(12, 1));
	cout << rb.IsBalance() << endl;
	
}
```



## ğŸŒ´æ€»ç»“

- çº¢é»‘æ ‘å®ç°çš„æ˜¯è¿‘ä¼¼å¹³è¡¡ï¼ŒAVLæ ‘åˆ™æ˜¯ä¸¥æ ¼å¹³è¡¡
- æ—‹è½¬æœ¬è´¨ä¸Šå°±åªæ˜¯æ”¹å˜äº†æ ‘çš„å½¢çŠ¶ï¼Œå¹¶æ²¡æœ‰æ”¹å˜æ ‘çš„æ€§è´¨ï¼ˆæ—‹è½¬å‰åéƒ½æ˜¯äºŒå‰æœç´¢æ ‘ï¼‰

åˆç†çš„æ—‹è½¬å¯ä»¥è¾¾åˆ°é™ä½æ ‘çš„é«˜åº¦ï¼Œåˆå› æœ¬èº«ä¸æ”¹å˜æ ‘çš„æ€§è´¨ï¼Œæ‰€ä»¥åˆç†çš„æ—‹è½¬å¯ä»¥é™ä½æ ‘çš„é«˜åº¦ï¼ˆavlæ ‘ï¼‰

- çº¢é»‘æ ‘çš„æ€§èƒ½æ¯”AVLæ ‘é«˜ï¼Œå› ä¸ºæ„é€ è¿‡ç¨‹ä¸­æ—‹è½¬æ¬¡æ•°æ›´å°‘ï¼Œæ‰€ä»¥å®é™…åº”ç”¨æ—¶å¤šè¿ç”¨çº¢é»‘æ ‘

- setå’Œmapçš„åº•å±‚æ˜¯çº¢é»‘æ ‘

- çº¢é»‘æ ‘çš„æ’å…¥åˆ é™¤æƒ…å†µå¾ˆå¤šï¼Œæ’å…¥è¾ƒä¸ºç®€å•ï¼Œæ—‹è½¬+å˜è‰²å³å¯ã€‚åˆ é™¤ä¸­åˆ é™¤é»‘è‰²å¶å­è¡ç”Ÿçš„æƒ…å†µè¾ƒå¤šï¼Œä½†å¤§ä½“ä¸Šéƒ½æ˜¯åœ¨Nçš„ä¸Šé¢å»åŠ ä¸€ä¸ªé»‘è‰²ç»“ç‚¹ï¼Œæ¥ä¿è¯é€šè¿‡è¿™æ¡è·¯å¾„çš„é»‘è‰²ç»“ç‚¹æ ‘ä¸å…¶ä»–è·¯å¾„ç›¸ç­‰ï¼Œè¿™ä¸ªå¢åŠ çš„é»‘è‰²ç»“ç‚¹å¯èƒ½ç”±æ—‹è½¬æ‰€å¾—ï¼Œä¹Ÿå¯èƒ½ç”±å˜è‰²æ‰€å¾—

  > å¦‚æœå“ªé‡Œå†™çš„æœ‰é—®é¢˜ï¼Œæ•¬è¯·æ–§æ­£ï¼

  ![image-20220505203956244](https://pic-1304888003.cos.ap-guangzhou.myqcloud.com/img/image-20220505203956244.png)
